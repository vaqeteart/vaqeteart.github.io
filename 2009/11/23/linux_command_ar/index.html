<!DOCTYPE html>
<html>
  <head><meta name="generator" content="Hexo 3.9.0">
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
<title>
    Linux命令学习手册-ar
</title>

<!--css-->
<!--link rel="stylesheet" href="/style.css" type="text/css" /-->
<link rel="stylesheet" href="../../../../css/partial/head.css">
<link rel="stylesheet" href="../../../../css/partial/header.css">
<link rel="stylesheet" href="../../../../css/partial/archives.css">
<link rel="stylesheet" href="../../../../css/partial/categories.css">
<link rel="stylesheet" href="../../../../css/partial/home-posts.css">
<link rel="stylesheet" href="../../../../css/partial/page-nav.css">
<link rel="stylesheet" href="../../../../css/partial/tags.css">
<link rel="stylesheet" href="../../../../css/partial/about.css">
<link rel="stylesheet" href="../../../../css/partial/more.css">
<link rel="stylesheet" href="../../../../css/partial/footer.css">
<link rel="stylesheet" href="../../../../css/post.css">
<link rel="stylesheet" href="../../../../css/orgmode/hexo_orgmode_style.css">


<!--javascript-->
<!--script type="text/javascript" src="/script.js"></script-->
<script src="../../../../lib/jquery-1.11.3.min.js"></script>
<script src="../../../../js/common.js"></script>
  </head>
  <body>
    <main class="main">
      <table class="container">
    <tbody id="tb_container">
        <tr id="tr_navbar">
            <script src="js/nav.js"></script>
<table class="navbar">
	<tbody>
		<tr>
			<th class="navitm">
				<a href="../../../../index.html">主页</a>
			</th>

			<th class="navitm">
				<a href="../../../../categories">分类</a>
				<div id="category_menus" class="second">
					
					<!--合并内部类和自定义类。
    每个分类的数据结构包括：
    id: 分类唯一id
    title: 分类名
    parent: 父分类id
    children:子分类数组
注：
内部类包含一个固定的分类结type="text/javascript"内部根分类设置为categories, title为分类在主题config.yml中有配置（待定）。
后续文章中设置的分类如果不是内部类都会被称作自定义类，可以通过hexo本身引擎检测出来。
最终内部类和自定义类会合并到完整分类(full_categories)中，这样让所有类能用json等通用方式表示，便于移植。

使用举例：
var category_info = getCategoriesInfo();
<x var symbols={}; x> //定义导出变量
<x- include('category_list', {symbols:symbols}) x> //包含该文件
<x var category_info = symbols.getCategoriesInfo(); x> //获取分类信息：包含分类树，以及分类与文章数映射表。
<x- symbols.list_category(category_info.categories, category_info.categories_count) x> //列出分类索引树

注： '<x' 是EJS模板语言的标记比如x为%。
-->

					
					<ul id="full_categories_tree" class="categories_tree categories_level0" type="none"><li id="categories" class="categories_tree_item"><a href="../../../../categories/" class="item_path"><span id="categories_switch" class="tree_switch">▷</span><span id="categories_title" class="item_title">分类</span><span id="categories_count" class="item_count">(58)</span></a><ul id="categories_tree" class="categories_tree categories_level2" type="none"><li id="note" class="categories_tree_item"><a href="../../../../categories/categories/note" class="item_path"><span id="note_switch" class="tree_switch">▷</span><span id="note_title" class="item_title">记事</span><span id="note_count" class="item_count">(6)</span></a><ul id="note_tree" class="categories_tree categories_level3" type="none"><li id="remind" class="categories_tree_item"><a href="../../../../categories/categories/note/remind" class="item_path"><span id="remind_switch" class="tree_switch">○</span><span id="remind_title" class="item_title">备忘</span><span id="remind_count" class="item_count">(0)</span></a></li><li id="plan" class="categories_tree_item"><a href="../../../../categories/categories/note/plan" class="item_path"><span id="plan_switch" class="tree_switch">○</span><span id="plan_title" class="item_title">计划</span><span id="plan_count" class="item_count">(0)</span></a></li>|</ul></li><li id="study" class="categories_tree_item"><a href="../../../../categories/categories/study" class="item_path"><span id="study_switch" class="tree_switch">▷</span><span id="study_title" class="item_title">学习</span><span id="study_count" class="item_count">(2)</span></a><ul id="study_tree" class="categories_tree categories_level3" type="none"><li id="problem" class="categories_tree_item"><a href="../../../../categories/categories/study/problem" class="item_path"><span id="problem_switch" class="tree_switch">○</span><span id="problem_title" class="item_title">问题</span><span id="problem_count" class="item_count">(0)</span></a></li><li id="git" class="categories_tree_item"><a href="../../../../categories/categories/study/git" class="item_path"><span id="git_switch" class="tree_switch">○</span><span id="git_title" class="item_title">git</span><span id="git_count" class="item_count">(1)</span></a></li><li id="os" class="categories_tree_item"><a href="../../../../categories/categories/study/os" class="item_path"><span id="os_switch" class="tree_switch">○</span><span id="os_title" class="item_title">操作系统</span><span id="os_count" class="item_count">(1)</span></a></li><li id="books" class="categories_tree_item"><a href="../../../../categories/categories/study/books" class="item_path"><span id="books_switch" class="tree_switch">▷</span><span id="books_title" class="item_title">books</span><span id="books_count" class="item_count">(0)</span></a><ul id="books_tree" class="categories_tree categories_level4" type="none"><li id="apue" class="categories_tree_item"><a href="../../../../categories/categories/study/books/apue" class="item_path"><span id="apue_switch" class="tree_switch">○</span><span id="apue_title" class="item_title">APUE</span><span id="apue_count" class="item_count">(0)</span></a></li>|</ul></li><li id="linux" class="categories_tree_item"><a href="../../../../categories/categories/study/linux" class="item_path"><span id="linux_switch" class="tree_switch">▷</span><span id="linux_title" class="item_title">linux</span><span id="linux_count" class="item_count">(3)</span></a><ul id="linux_tree" class="categories_tree categories_level4" type="none"><li id="misc" class="categories_tree_item"><a href="../../../../categories/categories/study/linux/misc" class="item_path"><span id="misc_switch" class="tree_switch">○</span><span id="misc_title" class="item_title">杂乱</span><span id="misc_count" class="item_count">(3)</span></a></li><li id="command" class="categories_tree_item"><a href="../../../../categories/categories/study/linux/command" class="item_path"><span id="command_switch" class="tree_switch">○</span><span id="command_title" class="item_title">命令</span><span id="command_count" class="item_count">(19)</span></a></li>|</ul></li><li id="jekyll" class="categories_tree_item"><a href="../../../../categories/categories/study/jekyll" class="item_path"><span id="jekyll_switch" class="tree_switch">○</span><span id="jekyll_title" class="item_title">jekyll</span><span id="jekyll_count" class="item_count">(0)</span></a></li><li id="kits" class="categories_tree_item"><a href="../../../../categories/categories/study/kits" class="item_path"><span id="kits_switch" class="tree_switch">○</span><span id="kits_title" class="item_title">工具</span><span id="kits_count" class="item_count">(1)</span></a></li><li id="emacs" class="categories_tree_item"><a href="../../../../categories/categories/study/emacs" class="item_path"><span id="emacs_switch" class="tree_switch">○</span><span id="emacs_title" class="item_title">emacs</span><span id="emacs_count" class="item_count">(2)</span></a></li><li id="vim" class="categories_tree_item"><a href="../../../../categories/categories/study/vim" class="item_path"><span id="vim_switch" class="tree_switch">○</span><span id="vim_title" class="item_title">vim</span><span id="vim_count" class="item_count">(0)</span></a></li>|</ul></li><li id="work" class="categories_tree_item"><a href="../../../../categories/categories/work" class="item_path"><span id="work_switch" class="tree_switch">▷</span><span id="work_title" class="item_title">工作</span><span id="work_count" class="item_count">(0)</span></a><ul id="work_tree" class="categories_tree categories_level3" type="none"><li id="progress" class="categories_tree_item"><a href="../../../../categories/categories/work/progress" class="item_path"><span id="progress_switch" class="tree_switch">○</span><span id="progress_title" class="item_title">进度</span><span id="progress_count" class="item_count">(0)</span></a></li>|</ul></li><li id="life" class="categories_tree_item"><a href="../../../../categories/categories/life" class="item_path"><span id="life_switch" class="tree_switch">▷</span><span id="life_title" class="item_title">生活</span><span id="life_count" class="item_count">(0)</span></a><ul id="life_tree" class="categories_tree categories_level3" type="none"><li id="experience" class="categories_tree_item"><a href="../../../../categories/categories/life/experience" class="item_path"><span id="experience_switch" class="tree_switch">○</span><span id="experience_title" class="item_title">经验</span><span id="experience_count" class="item_count">(0)</span></a></li><li id="tips" class="categories_tree_item"><a href="../../../../categories/categories/life/tips" class="item_path"><span id="tips_switch" class="tree_switch">○</span><span id="tips_title" class="item_title">技巧</span><span id="tips_count" class="item_count">(0)</span></a></li>|</ul></li><li id="others" class="categories_tree_item"><a href="../../../../categories/categories/others" class="item_path"><span id="others_switch" class="tree_switch">▷</span><span id="others_title" class="item_title">其它</span><span id="others_count" class="item_count">(4)</span></a><ul id="others_tree" class="categories_tree categories_level3" type="none"><li id="rambles" class="categories_tree_item"><a href="../../../../categories/categories/others/rambles" class="item_path"><span id="rambles_switch" class="tree_switch">○</span><span id="rambles_title" class="item_title">随笔</span><span id="rambles_count" class="item_count">(0)</span></a></li><li id="temp" class="categories_tree_item"><a href="../../../../categories/categories/others/temp" class="item_path"><span id="temp_switch" class="tree_switch">○</span><span id="temp_title" class="item_title">临时</span><span id="temp_count" class="item_count">(0)</span></a></li><li id="test" class="categories_tree_item"><a href="../../../../categories/categories/others/test" class="item_path"><span id="test_switch" class="tree_switch">○</span><span id="test_title" class="item_title">测试</span><span id="test_count" class="item_count">(0)</span></a></li>|</ul></li>|</ul></li></ul>
				</div>
			</th>

			<th class="navblank"></th>

			<th class="navitm">
				<a href="../../../../tags">标签</a>
				<div id="tag_menus" class="second">
					<ul class="tag-list"></ul>
				</div>
			</th>

			<th class="navitm">
				<a href="../../../../archives">归档</a>
			</th>

			<th class="navblank"></th>

			<th class="navitm">
				<a href="../../../../more">更多</a>
			</th>

			<th class="navitm">
				<a href="../../../../about">关于</a>
			</th>

			<th class="navblank" style="width:25%;"></th>

			<th class="navitm" style="margin:0; padding:0;border:none;">
				<form method="get" id="searchform" action="/search.html" style="margin:0;padding:0;height:100%;">
					<span style="color:#00FF00;">Q</span>
					<span style="border-style:solid; border-width:1px; border-color:#00FF00;
		  		border-top:0px; border-left:0px;border-right:0px; 
				margin:0;padding:0;height:100%;">
						<input value="Search by title (canbe regex)..." name="s" class="s" onfocus="if (this.value == 'Search by title (canbe regex)...') {this.value = '';}" onblur="if (this.value == '') {this.value = 'Search by title (canbe regex)...';}" style="margin:0;padding:0;height:100%;border:none;background: #000000; color:#00A600;" type="text">
					</span>
					<!--input type="submit" value="Q" style="width:20%;"-->
				</form>
			</th>

			<th class="navblank"></th>

			<th class="navblank"></th>

			<a href="#" id="topbtn">⇑</a>

			<a href="#bottom" id="bottombtn">⇓</a>
			<!--⇐⇑⇒⇓-->
		</tr><tr>
	</tr></tbody>
</table>
        </tr>
        <tr>
            <td id="td_page_header" colspan="6" valign="top" align="right" style="width:100%;">
        <header style="text-align: center;">
        <h1>
               <a href="/" title="Menu.Home">
               QuietHeart's Site
               </a>
        </h1>
        </header>
</td>    
        </tr>
        <tr>
            <td id="td_posts" colspan="6" valign="top">
                <article>
                    <h1 id="header1" style="text-align: center;">
                        Linux命令学习手册-ar
                    </h1>
                    <hr id="title_line">
                    <div>
                        <div id="table-of-contents">
<h2>&#30446;&#24405;</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgheadline1">1. 功能</a></li>
<li><a href="#orgheadline2">2. 描述</a>
<ul>
<li><a href="#orgheadline3">2.1. 选项</a></li>
<li><a href="#orgheadline4">2.2. 退出状态</a></li>
</ul>
</li>
<li><a href="#orgheadline5">3. 举例</a>
<ul>
<li><a href="#orgheadline6">3.1. 查看 <code>ar</code> 的版本号</a></li>
<li><a href="#orgheadline7">3.2. 要创建一个库</a></li>
<li><a href="#orgheadline8">3.3. 创建一个库的另一个方法</a></li>
<li><a href="#orgheadline9">3.4. 查看库中的所有模块</a></li>
<li><a href="#orgheadline10">3.5. 删除库中的指定模块</a></li>
<li><a href="#orgheadline11">3.6. 将库中指定的模块提取出来</a></li>
<li><a href="#orgheadline12">3.7. 打印成员的内容</a></li>
<li><a href="#orgheadline13">3.8. 解压缩并重命名一个成员</a></li>
<li><a href="#orgheadline14">3.9. 要指定在模块的前面插入新成员</a></li>
<li><a href="#orgheadline15">3.10. 要指定在模块的后面插入新成员</a></li>
<li><a href="#orgheadline16">3.11. 要替换或添加新成员到库中</a></li>
<li><a href="#orgheadline17">3.12. 要更新一个已经更改过的成员</a></li>
<li><a href="#orgheadline18">3.13. 更改库成员的顺序</a></li>
</ul>
</li>
<li><a href="#orgheadline19">4. 其它</a>
<ul>
<li><a href="#orgheadline20">4.1. 利用库文件进行编译举例1(后面有简化)</a>
<ul>
<li><a href="#orgheadline21">4.1.1. 编辑 <code>hello1.c/h hello2.c/h hello3.c/h hello4.c/h hello5.c/h hello6.c/h</code></a></li>
<li><a href="#orgheadline22">4.1.2. 编译生成目标文件（模块）</a></li>
<li><a href="#orgheadline23">4.1.3. 打成 <code>libhello.a</code> 库包</a></li>
<li><a href="#orgheadline24">4.1.4. 编辑 <code>main.c</code></a></li>
<li><a href="#orgheadline25">4.1.5. 建立一个子文件夹 <code>program/</code>,把 <code>hello*.h</code> 和 <code>main.c</code> 移动到 <code>program</code> 里面并且利用刚才的库编译 <code>main.c</code>:</a></li>
<li><a href="#orgheadline26">4.1.6. 运行测试</a></li>
</ul>
</li>
<li><a href="#orgheadline27">4.2. 利用库进行编译链接举例2（对例1的简化）</a>
<ul>
<li><a href="#orgheadline28">4.2.1. 过程同上例1，不同的唯一之处是：</a></li>
<li><a href="#orgheadline29">4.2.2. 编译运行</a></li>
</ul>
</li>
<li><a href="#orgheadline30">4.3. 利用库进行编译链接举例3（对例3的进一步简化，这样看不到接口头文件了）：</a>
<ul>
<li><a href="#orgheadline31">4.3.1. 过程同上例2，不同的唯一之处是：</a></li>
<li><a href="#orgheadline32">4.3.2. 编译运行</a></li>
</ul>
</li>
<li><a href="#orgheadline33">4.4. 参考资料：</a></li>
</ul>
</li>
</ul>
</div>
</div>


<p>
<code>ar [-c] [-l] [-g|-o] [-s] [-v] [-C] [-T] [-z] {-h|-p|-t|-x} [-X {32|64|32_64}] ArchiveFile [File ...]</code>
</p>

<p>
<code>ar [-c] [-l] [-g|-o] [-s] [-v] [-C] [-T] [-z] {-m|-r [-u]} [{-a|-b|-i} PositionName] [-X {32|64|32_64}] ArchiveFile File ...</code>
</p>

<p>
<code>ar [-c] [-l] [-g|-o] [-s] [-v] [-C] [-T] [-z] {-d|-q} [-X {32|64|32_64}] ArchiveFile File ...</code>
</p>

<p>
<code>ar [-c] [-l] [-v] [-C] [-T] [-z] {-g|-o|-s|-w} [-X {32|64|32_64}] ArchiveFile</code>
</p>


<div id="outline-container-orgheadline1" class="outline-2">
<h2 id="orgheadline1"><span class="section-number-2">1</span> 功能</h2>
<div class="outline-text-2" id="text-1">
<p>
<code>ar</code> 命令可以用来创建、修改库，也可以从库中提出单个模块。库是一单独的文件，里面包含了按照特定的结构组织起来的其它的一些文件（称做此库文件的 <code>member</code> ）。原始文件的内容、模式、时间戳、属主、组等属性都保留在库文件中。
</p>
</div>
</div>

<div id="outline-container-orgheadline2" class="outline-2">
<h2 id="orgheadline2"><span class="section-number-2">2</span> 描述</h2>
<div class="outline-text-2" id="text-2">
<p>
当我们的程序中有经常使用的模块，而且这种模块在其他程序中也会用到，这时按照软件重用的思想，我们应该将它们生成库，使得以后编程可以减少开发代码量。
</p>
</div>

<div id="outline-container-orgheadline3" class="outline-3">
<h3 id="orgheadline3"><span class="section-number-3">2.1</span> 选项</h3>
<div class="outline-text-3" id="text-2-1">
<p>
选项前可以有 <code>-</code> 字符，也可以没有。
</p>

<p>
<code>-a PositionName</code> 在 <code>PositionName</code> 参数标识的现有文件后安置指定的文件。 
</p>

<p>
<code>-b PositionName</code> 在 <code>PositionName</code> 参数标识的现有文件前安置指定的文件。 
</p>

<p>
<code>-c</code> 禁止在创建库时产生的正常消息。 
</p>

<p>
<code>-C</code> 阻止解压缩的文件替换文件系统中同名的文件。 
</p>

<p>
<code>-d</code> 从库中删除指定的文件。 
</p>

<p>
<code>-g</code> 对压缩文档成员进行排序以确保用最小数量的未用空间获得最大的加载效率。在几乎所有情况下， <code>-g</code> 标志以压缩文档成员的逻辑链接顺序物理地安置它们。最终生成的压缩文档通常写成小格式，这样该标志可用来将大格式压缩文档转换成小格式压缩文档。包含 64 位 XCOFF 对象的压缩文档不能创建成或转换至小格式。 
</p>

<p>
<code>-h</code> 将指定的文件的成员报头中的修改时间设置为当前日期和时间。如果不指定任何文件名称，则 <code>ar</code> 命令设置所有成员报头的时间戳记。此标志不能和 <code>-z</code> 标志一起使用。 
</p>

<p>
<code>-i PositionName</code> 在 <code>PositionName</code> 参数标识的现有文件前安置指定的文件（和 <code>-b</code> 相同）。 
</p>

<p>
<code>-l</code> 将临时文件置于当前（本地）目录中，而非 <code>TMPDIR</code> 目录中（缺省为 <code>/tmp</code> ）。 
</p>

<p>
<code>-m</code> 将指定的文件移动到库中的某个其它位置。缺省情况下，它将指定的文件移动到库的末尾。使用位置标志（ <code>abi</code> ）来指定某个其它位置。 
</p>

<p>
<code>-o</code> 对压缩文档成员进行排序以确保用最小数量的未用空间获得最大的加载效率。在几乎所有情况下， <code>-o</code> 标志以压缩文档成员的逻辑链接顺序物理地安置它们。最终生成的压缩文档通常写成大格式，这样该标志可用来将小格式压缩文档转换成大格式压缩文档。 
</p>

<p>
<code>-p</code> 将 <code>Files</code> 参数中指定的文件的内容或在 <code>ArchiveFile</code> 参数中指定的所有文件（如果您不指定任何文件）都写至标准输出。 
</p>

<p>
<code>-q</code> 将指定的文件添加到库的末尾。另外，如果指定同一个文件两次，它可能被放入库中两次。 
</p>

<p>
<code>-r</code> 如果指定的文件已经存在于库中，则替换它。因为指定的文件在库中占据它们替换的文件的同一个位置，位置标志没有任何附加的影响。当和 <code>-u</code> 标志（更新）一起使用时， <code>-r</code> 标志仅替换自从最后一次添加到库中以后修改的文件。 如果指定的文件不存在于库中，则 <code>ar</code> 命令添加它。在这种情况下，位置标志影响放置。如果不指定位置，则将新文件置于库的末尾。如果指定同一个文件两次，它可能被放入库中两次。
</p>

<p>
<code>-s</code> 无论 <code>ar</code> 命令是否修改了库内容都强制重新生成库符号表。请在库上使用 <code>strip</code> 命令之后，使用此标志来恢复库符号表。 
</p>

<p>
<code>-t</code> 将库的目录写至标准输出。如果指定文件名称，则仅显示指定的那些文件。如果不指定任何文件， <code>-t</code> 标志列出库中的所有文件。 
</p>

<p>
<code>-T</code> 如果压缩文档成员名称比文件系统支持的长，则允许文件名称截短。此选项无效，因为文件系统支持的名称长度等于 <code>255</code> 个字符的最大压缩文档成员名称。 
</p>

<p>
<code>-u</code> 仅复制自它们最后一次复制起更改的文件（请参阅先前讨论过的 <code>-r</code> 标志）。 
</p>

<p>
<code>-v</code> 将建立新库的详细的逐个文件的描述写至标准输出。当和 <code>-t</code> 标志一起使用时，它给出类似于 <code>ls -l</code> 命令给出的长列表。当和 <code>-x</code> 标志一起使用时，它在每个文件前加一个名称。当和 <code>-h</code> 标志一起使用，它列出成员名称和更新的修改时间。 
</p>

<p>
<code>-w</code> 显示压缩文档符号表。每个符号和其中定义此符号的文件的名称一起列出。 
</p>

<p>
<code>-x</code> 通过将指定的文件复制到当前目录来解压缩它们。这些副本和原始文件（保留在库中）具有相同的名称。如果不指定任何文件，=-x= 标志复制库中的所有文件。此过程不会更改库。 
</p>

<p>
<code>-X mode</code> 指定 <code>ar</code> 应检查的目标文件的类型。 <code>mode</code> 必须是以下项之一： 
</p>

<ul class="org-ul">
<li><code>32</code> 仅处理 <code>32</code> 位目标文件</li>

<li><code>64</code> 仅处理 <code>64</code> 位目标文件</li>

<li><code>32_64</code> 处理 <code>32</code> 位 和 <code>64</code> 位目标文件</li>
</ul>

<p>
缺省值是处理 <code>32</code> 位目标文件（忽略 <code>64</code> 位对象）。 <code>mode</code> 还可以用 <code>OBJECT_MODE</code> 环境变量来设置。例如， <code>OBJECT_MODE=64</code> 使 <code>ar</code> 处理任何 <code>64</code> 位对象并忽略 <code>32</code> 位对象。=-X= 标志覆盖 <code>OBJECT_MODE</code> 变量。 
</p>

<p>
<code>-z</code> 创建压缩文档的临时副本并对副本执行所有要求的修改。当所有操作成功完成时，压缩文档的工作副本覆盖原始副本。此标志不能和 <code>-h</code> 标志一起使用。 
</p>

<p>
<code>ArchiveFile</code> 指定压缩文档文件名称；必需。 
</p>

<p>
<code>MemberName ...</code> 各压缩文档成员的名称。 
</p>
</div>
</div>

<div id="outline-container-orgheadline4" class="outline-3">
<h3 id="orgheadline4"><span class="section-number-3">2.2</span> 退出状态</h3>
<div class="outline-text-3" id="text-2-2">
<p>
该命令返回以下出口值：
</p>

<p>
<code>0</code> 成功完成。 
</p>

<p>
<code>&gt;0</code> 发生错误。
</p>
</div>
</div>
</div>

<div id="outline-container-orgheadline5" class="outline-2">
<h2 id="orgheadline5"><span class="section-number-2">3</span> 举例</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-orgheadline6" class="outline-3">
<h3 id="orgheadline6"><span class="section-number-3">3.1</span> 查看 <code>ar</code> 的版本号</h3>
<div class="outline-text-3" id="text-3-1">
<div class="org-src-container">

<pre class="src src-sh">$ar -V
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline7" class="outline-3">
<h3 id="orgheadline7"><span class="section-number-3">3.2</span> 要创建一个库</h3>
<div class="outline-text-3" id="text-3-2">
<div class="org-src-container">

<pre class="src src-sh">$ar -rv libhello.a hello1.o hello2.o hello3.o hello4.o hello5.o hello6.o
</pre>
</div>

<p>
输入之后，输出如下：
</p>
<pre class="example">
ar: creating libhello.a
a - hello1.o
a - hello2.o
a - hello3.o
a - hello4.o
a - hello5.o
a - hello6.o
</pre>

<p>
这里，从多个用 <code>ld</code> 命令创建的共享模块( <code>hello*.o</code> 目标文件)中创建一个压缩文档库,编译并链接如何使用这个库文件本文有举例。注意这里的添加顺序。 <code>-v</code> 标志设置详细方式，在此方式中 <code>ar</code> 命令在其进行时显示进程报告，如果没有这个 <code>v</code> 将只显示：
</p>
<pre class="example">
ar: creating libhello.a。
</pre>
</div>
</div>

<div id="outline-container-orgheadline8" class="outline-3">
<h3 id="orgheadline8"><span class="section-number-3">3.3</span> 创建一个库的另一个方法</h3>
<div class="outline-text-3" id="text-3-3">
<div class="org-src-container">

<pre class="src src-sh">$ar -qv libhello.a hello1.o hello2.o hello3.o hello4.o hello5.o hello6.o
</pre>
</div>

<p>
这里，如果 <code>libhello.a</code> 库不存在，则此命令创建它，并将文件 <code>hello1.o-hello6.o</code> 的副本输入其中。如果 <code>libhello.a</code> 库存在，则此命令在不检查相同成员的情况下，将新的成员添加到末尾。
</p>
</div>
</div>

<div id="outline-container-orgheadline9" class="outline-3">
<h3 id="orgheadline9"><span class="section-number-3">3.4</span> 查看库中的所有模块</h3>
<div class="outline-text-3" id="text-3-4">
<div class="org-src-container">

<pre class="src src-sh">$ar -t libhello.a
</pre>
</div>

<p>
输入之后，输出如下：
</p>
<pre class="example">
hello1.o
hello2.o
hello3.o
hello4.o
hello5.o
hello6.o
</pre>

<p>
这样会依次列出库中所有的模块成员。显示的次序不是根据名字的，而是添加模块时候决定的。加 <code>-v</code> 则类似 <code>ls -l</code> 的长格式。
</p>
</div>
</div>

<div id="outline-container-orgheadline10" class="outline-3">
<h3 id="orgheadline10"><span class="section-number-3">3.5</span> 删除库中的指定模块</h3>
<div class="outline-text-3" id="text-3-5">
<div class="org-src-container">

<pre class="src src-sh">$ar -dv libhello.a hello3.o
</pre>
</div>

<p>
输入之后输出如下：
</p>
<pre class="example">
d - hello3.o
</pre>

<p>
这样会在库中删除指定的模块成员 <code>hello3.o</code> ，加 <code>-v</code> 是为了显示删除什么文件。下面用详细方式显示删除后的库文件如下：
</p>
<div class="org-src-container">

<pre class="src src-sh">$ar -tv libhello.a
</pre>
</div>

<p>
输入之后输出如下：
</p>
<pre class="example">
rw-r--r-- 14506/1001   1488 Jul  4 14:23 2009 hello1.o
rw-r--r-- 14506/1001   1488 Jul  4 14:23 2009 hello2.o
rw-r--r-- 14506/1001   1488 Jul  4 14:23 2009 hello4.o
rw-r--r-- 14506/1001   1488 Jul  4 14:23 2009 hello5.o
rw-r--r-- 14506/1001   1488 Jul  4 14:23 2009 hello6.o
</pre>
</div>
</div>

<div id="outline-container-orgheadline11" class="outline-3">
<h3 id="orgheadline11"><span class="section-number-3">3.6</span> 将库中指定的模块提取出来</h3>
<div class="outline-text-3" id="text-3-6">
<div class="org-src-container">

<pre class="src src-sh">$ar -xv libhello.a hello1.o
</pre>
</div>

<p>
输入之后，输出如下：
</p>
<pre class="example">
x - hello1.o
</pre>

<p>
这样,会将库中的模块 <code>hello1.o</code> 释放到当前的文件夹，不会在库中删除该模块。这里实际是加 <code>-v</code> 选项是为了显示输出删除了那个模块。
</p>
</div>
</div>

<div id="outline-container-orgheadline12" class="outline-3">
<h3 id="orgheadline12"><span class="section-number-3">3.7</span> 打印成员的内容</h3>
<div class="outline-text-3" id="text-3-7">
<div class="org-src-container">

<pre class="src src-sh">$ar -pv libhello.a hello1.o
</pre>
</div>

<p>
输入之后，输出如下：
</p>
<pre class="example">
^?ELF^B^A^A^@^@^@^@^@^@^@^@^@^A^@&gt;^@^A^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@(^A^@^@^@^@^@^@^@^@^@^@@^@^@^@^@^@@^@^M^@
.....由于篇幅关系，后面省略了......
</pre>

<p>
这里，打印的是 <code>hello1.o</code> 的内容，估计我们也看不懂,如果不加 <code>-v</code> 选项，就不会打印第一行的了。
</p>
</div>
</div>

<div id="outline-container-orgheadline13" class="outline-3">
<h3 id="orgheadline13"><span class="section-number-3">3.8</span> 解压缩并重命名一个成员</h3>
<div class="outline-text-3" id="text-3-8">
<div class="org-src-container">

<pre class="src src-sh">$ar -p libhello.a hello1.o &gt;hello1copy.o
</pre>
</div>

<p>
此命令将成员 <code>hello.o</code> 复制到一个名为 <code>hello1copy.o</code> 的文件,实际就是一个重定向的操作。
</p>
</div>
</div>


<div id="outline-container-orgheadline14" class="outline-3">
<h3 id="orgheadline14"><span class="section-number-3">3.9</span> 要指定在模块的前面插入新成员</h3>
<div class="outline-text-3" id="text-3-9">
<div class="org-src-container">

<pre class="src src-sh">$ar -rb hello1.o libhello.a hello3.o
</pre>
</div>
<p>
或
</p>
<div class="org-src-container">

<pre class="src src-sh">$ar -ri hello1.o libhello.a hello3.o
</pre>
</div>

<p>
这样,没用 <code>-v</code> 所以没有输出，但会把 <code>hello3.o</code> 插入 <code>libtest.a</code> 中，并且在 <code>hello1.o</code> 模块前.用 <code>-t</code> 可以看到次序如下：
</p>
<div class="org-src-container">

<pre class="src src-sh">$ar -tv libhello.a
</pre>
</div>

<p>
输入之后，输出如下：
</p>
<pre class="example">
rw-r--r-- 14506/1001   1488 Jul  4 14:24 2009 hello3.o
rw-r--r-- 14506/1001   1488 Jul  4 14:23 2009 hello1.o
rw-r--r-- 14506/1001   1488 Jul  4 14:23 2009 hello2.o
rw-r--r-- 14506/1001   1488 Jul  4 14:23 2009 hello4.o
rw-r--r-- 14506/1001   1488 Jul  4 14:23 2009 hello5.o
rw-r--r-- 14506/1001   1488 Jul  4 14:23 2009 hello6.o
</pre>

<p>
如果要插入的成员已经存在于库中，结果相当于将原来的同名模块删除，之后再插入,如下：
</p>
<div class="org-src-container">

<pre class="src src-sh">quietheart@ubuntu:~/libTest/hellolib/ver2obj/bak$ar -rb hello4.o libhello.a hello3.o
quietheart@ubuntu:~/libTest/hellolib/ver2obj/bak$ar -tv libhello.a
</pre>
</div>

<p>
输入之后，输出如下：
</p>
<pre class="example">
rw-r--r-- 14506/1001   1488 Jul  4 14:23 2009 hello1.o
rw-r--r-- 14506/1001   1488 Jul  4 14:23 2009 hello2.o
rw-r--r-- 14506/1001   1488 Jul  4 14:25 2009 hello3.o
rw-r--r-- 14506/1001   1488 Jul  4 14:23 2009 hello4.o
rw-r--r-- 14506/1001   1488 Jul  4 14:23 2009 hello5.o
rw-r--r-- 14506/1001   1488 Jul  4 14:23 2009 hello6.o
</pre>

<p>
在这里，我们用 <code>-v</code> 选项会显示详细的插入信息，这里我修改了 <code>hello3.o</code> 的内容，如果不修改，那么始终时间是 <code>14:23</code> 怎么加都是。
</p>
</div>
</div>


<div id="outline-container-orgheadline15" class="outline-3">
<h3 id="orgheadline15"><span class="section-number-3">3.10</span> 要指定在模块的后面插入新成员</h3>
<div class="outline-text-3" id="text-3-10">
<div class="org-src-container">

<pre class="src src-sh">$ar -ra hello2.o libhello.a hello3.o
</pre>
</div>

<p>
这里的操作和 <code>rb</code> 或者 <code>ri</code> 选项指定的在前面插入原理一样，不过插入的方向变成了在后面追加插入了。用 <code>-v</code> 会显示详细的插入信息。
</p>
</div>
</div>

<div id="outline-container-orgheadline16" class="outline-3">
<h3 id="orgheadline16"><span class="section-number-3">3.11</span> 要替换或添加新成员到库中</h3>
<div class="outline-text-3" id="text-3-11">
<div class="org-src-container">

<pre class="src src-sh">$ar -r libhello.a hello6.o
</pre>
</div>

<p>
这样，如果 <code>libhello.a</code> 库中没有 <code>hello6.o</code> 那么就会把模块 <code>hello6.o</code> 添加到库的末尾，如果有的话就会替换之（ 位置还是原来的位置）。
</p>
</div>
</div>


<div id="outline-container-orgheadline17" class="outline-3">
<h3 id="orgheadline17"><span class="section-number-3">3.12</span> 要更新一个已经更改过的成员</h3>
<div class="outline-text-3" id="text-3-12">
<div class="org-src-container">

<pre class="src src-sh">$ar -ru libhello.a hello3.o
</pre>
</div>

<p>
这时候，仅当 <code>hello3.o</code> 比库中的 <code>hello3.o</code> 更新时或者没有在库中时才替代库中的 <code>hello3.o</code> 或者加入 <code>hello3.o</code> .
</p>
</div>
</div>


<div id="outline-container-orgheadline18" class="outline-3">
<h3 id="orgheadline18"><span class="section-number-3">3.13</span> 更改库成员的顺序</h3>
<div class="outline-text-3" id="text-3-13">
<div class="org-src-container">

<pre class="src src-sh">$ar -mav hello4.o libhello.a hello1.o hello3.o
</pre>
</div>

<p>
输入之后，输出如下：
</p>
<pre class="example">
m - hello1.o
m - hello3.o
</pre>

<p>
此命令将成员 <code>hello1.o</code> 和 <code>hello3.o</code> 移动到 <code>hello4.o</code> 后面。当库中如果有若干模块有相同的符号定义(如函数定义)，则成员的位置顺序很重要。
</p>

<p>
如果没有指定任选项，任何指定的成员将移到库的最后。也可以使用 <code>a</code>, <code>b</code>,或 <code>i</code> 任选项移动到指定的位置。检查结果如下：
</p>
<div class="org-src-container">

<pre class="src src-sh">$ar -tv libhello.a
</pre>
</div>

<p>
输入之后，输出如下：
</p>
<pre class="example">
rw-r--r-- 14506/1001   1488 Jul  4 14:23 2009 hello2.o
rw-r--r-- 14506/1001   1488 Jul  4 14:23 2009 hello4.o
rw-r--r-- 14506/1001   1488 Jul  4 14:23 2009 hello3.o
rw-r--r-- 14506/1001   1488 Jul  4 14:23 2009 hello1.o
rw-r--r-- 14506/1001   1488 Jul  4 14:23 2009 hello5.o
rw-r--r-- 14506/1001   1488 Jul  4 14:23 2009 hello6.o
</pre>

<p>
这里，注意，发现参考资料中别人的解释和实践之后的结果不一样，那个参考资料这样说的：
</p>
<div class="org-src-container">

<pre class="src src-sh">$ar -v -m -a strcmp.o lib.a strcat.o strcpy.o
</pre>
</div>

<p>
此命令将成员 <code>strcat.o</code> 和 <code>strcpy.o</code> 移动到紧跟在 <code>strcmp.o</code> 成员之后的位置。保留 <code>strcat.o</code> 和 <code>strcpy.o</code> 成员的相对顺序。换句话说，如果在移动之前 <code>strcpy.o</code> 成员在 <code>strcat.o</code> 成员之前，那么（移动后）它依旧如此。可是我运行了这个命令发现相对次序也变化了？？
</p>
</div>
</div>
</div>

<div id="outline-container-orgheadline19" class="outline-2">
<h2 id="orgheadline19"><span class="section-number-2">4</span> 其它</h2>
<div class="outline-text-2" id="text-4">
</div><div id="outline-container-orgheadline20" class="outline-3">
<h3 id="orgheadline20"><span class="section-number-3">4.1</span> 利用库文件进行编译举例1(后面有简化)</h3>
<div class="outline-text-3" id="text-4-1">
</div><div id="outline-container-orgheadline21" class="outline-4">
<h4 id="orgheadline21"><span class="section-number-4">4.1.1</span> 编辑 <code>hello1.c/h hello2.c/h hello3.c/h hello4.c/h hello5.c/h hello6.c/h</code></h4>
<div class="outline-text-4" id="text-4-1-1">
<p>
内容如下：
</p>
<div class="org-src-container">

<pre class="src src-C">//hello1.h
  1 int hello1();
//hello2.h-hello6.h的内容类似，不过把hello1替换成相应的hello2-hello6了.
</pre>
</div>

<div class="org-src-container">

<pre class="src src-C">//hello1.c
  1 #include
  2 #include "hello1.h"
  3 int hello1()
  4 {
  5     printf("hello1\n");
  6 }
//hello2.c-hello6.c的内容类似，不过把hello1替换成相应的hello2-hello6了.
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline22" class="outline-4">
<h4 id="orgheadline22"><span class="section-number-4">4.1.2</span> 编译生成目标文件（模块）</h4>
<div class="outline-text-4" id="text-4-1-2">
<div class="org-src-container">

<pre class="src src-sh">$gcc -c hello*.c
</pre>
</div>

<p>
这样会在当前目录下面生成 <code>hello1.o hello2.o hello3.o hello4.o hello5.o hello6.o</code>
</p>
</div>
</div>

<div id="outline-container-orgheadline23" class="outline-4">
<h4 id="orgheadline23"><span class="section-number-4">4.1.3</span> 打成 <code>libhello.a</code> 库包</h4>
<div class="outline-text-4" id="text-4-1-3">
<div class="org-src-container">

<pre class="src src-sh">$ar -rv libhello.a hello*.o
</pre>
</div>
<p>
这样会把所有的 <code>.o</code> 文件做为模块打包进 <code>libhello.a</code> 库中。
</p>
</div>
</div>

<div id="outline-container-orgheadline24" class="outline-4">
<h4 id="orgheadline24"><span class="section-number-4">4.1.4</span> 编辑 <code>main.c</code></h4>
<div class="outline-text-4" id="text-4-1-4">
<div class="org-src-container">

<pre class="src src-C">//main.c
  1 #include
  2 #include"hello1.h"
  3 #include"hello3.h"
  4
  5 int main(int argc, char *argv[])
  6 {
  7     hello1();
  8     hello3();
  9     return 0;
 10 }
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline25" class="outline-4">
<h4 id="orgheadline25"><span class="section-number-4">4.1.5</span> 建立一个子文件夹 <code>program/</code>,把 <code>hello*.h</code> 和 <code>main.c</code> 移动到 <code>program</code> 里面并且利用刚才的库编译 <code>main.c</code>:</h4>
<div class="outline-text-4" id="text-4-1-5">
<div class="org-src-container">

<pre class="src src-sh">$mkdir program;mv hello*.h program;mv main.c hello*.h;cd program
$gcc -o main main.c -L ../ -lhello
</pre>
</div>
<p>
这样，在 <code>program</code> 中生成了 <code>main</code> ，编译命令的 <code>-L</code> 选项指定库的路径， <code>-l</code> 指定 <code>ld</code> 链接的库的名字，即 <code>libhello.a</code> 中的 <code>hello</code> 。
</p>
</div>
</div>

<div id="outline-container-orgheadline26" class="outline-4">
<h4 id="orgheadline26"><span class="section-number-4">4.1.6</span> 运行测试</h4>
<div class="outline-text-4" id="text-4-1-6">
<div class="org-src-container">

<pre class="src src-sh">$./main
</pre>
</div>

<p>
输入之后，输出如下：
</p>
<pre class="example">
hello1
hello3
</pre>
</div>
</div>
</div>


<div id="outline-container-orgheadline27" class="outline-3">
<h3 id="orgheadline27"><span class="section-number-3">4.2</span> 利用库进行编译链接举例2（对例1的简化）</h3>
<div class="outline-text-3" id="text-4-2">
</div><div id="outline-container-orgheadline28" class="outline-4">
<h4 id="orgheadline28"><span class="section-number-4">4.2.1</span> 过程同上例1，不同的唯一之处是：</h4>
<div class="outline-text-4" id="text-4-2-1">
<p>
<code>hello*.c</code> 中不需要包含 <code>hello*.h</code> 头文件，
</p>

<p>
其内容如下：
</p>
<div class="org-src-container">

<pre class="src src-C">//hello1.c
  1 #include
  2 //#include "hello1.h"
  3 int hello1()
  4 {
  5     printf("hello1\n");
  6 }
//hello2.c-hello6.c的内容类似，不过把hello1替换成相应的hello2-hello6了.
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline29" class="outline-4">
<h4 id="orgheadline29"><span class="section-number-4">4.2.2</span> 编译运行</h4>
<div class="outline-text-4" id="text-4-2-2">
<div class="org-src-container">

<pre class="src src-sh">$gcc -o main main.c -L ../ -lhello
</pre>
</div>
<p>
这样编译之后，照样能运行。
</p>
</div>
</div>
</div>

<div id="outline-container-orgheadline30" class="outline-3">
<h3 id="orgheadline30"><span class="section-number-3">4.3</span> 利用库进行编译链接举例3（对例3的进一步简化，这样看不到接口头文件了）：</h3>
<div class="outline-text-3" id="text-4-3">
</div><div id="outline-container-orgheadline31" class="outline-4">
<h4 id="orgheadline31"><span class="section-number-4">4.3.1</span> 过程同上例2，不同的唯一之处是：</h4>
<div class="outline-text-4" id="text-4-3-1">
<p>
<code>main.c</code> 中不需要包含 <code>hello*.h</code> 头文件了（即所有文件任何地方都不需要头文件了），
</p>

<p>
其内容如下：
</p>
<div class="org-src-container">

<pre class="src src-C">//main.c
  1 #include
  2 //#include"hello1.h"
  3 //#include"hello3.h"
  4
  5 int main(int argc, char *argv[])
  6 {
  7     hello1();
  8     hello3();
  9     return 0;
 10 }
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline32" class="outline-4">
<h4 id="orgheadline32"><span class="section-number-4">4.3.2</span> 编译运行</h4>
<div class="outline-text-4" id="text-4-3-2">
<div class="org-src-container">

<pre class="src src-sh">$gcc -o main main.c -L ../ -lhello
</pre>
</div>
<p>
这样编译之后，照样能运行。
</p>
</div>
</div>
</div>

<div id="outline-container-orgheadline33" class="outline-3">
<h3 id="orgheadline33"><span class="section-number-3">4.4</span> 参考资料：</h3>
<div class="outline-text-3" id="text-4-4">
<p>
<a href="http://www.kuqin.com/aixcmds/aixcmds1/ar.htm#a0949a5b" target="_blank" rel="noopener">http://www.kuqin.com/aixcmds/aixcmds1/ar.htm#a0949a5b</a>
</p>

<p>
<a href="http://www.cppblog.com/prayer/archive/2009/05/27/85877.html" target="_blank" rel="noopener">http://www.cppblog.com/prayer/archive/2009/05/27/85877.html</a>
</p>
</div>
</div>
</div>

                    </div>
                </article>                        
                
                <!--{% include duoshuo_comment.ext %}-->
            </td>
        </tr>
        <tr>
            <td id="td_page_footer" colspan="6">
    <footer>
        &copy 2015
    </footer>
    <a id="bottom"></a>
</td>
        </tr>
    </tbody>
</table>
    </main>
  </body>
</html>