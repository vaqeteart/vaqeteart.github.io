<!DOCTYPE html>
<html>
  <head><meta name="generator" content="Hexo 3.9.0">
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
<title>
    Linux命令学习手册-sed
</title>

<!--css-->
<!--link rel="stylesheet" href="/style.css" type="text/css" /-->
<link rel="stylesheet" href="../../../../css/partial/head.css">
<link rel="stylesheet" href="../../../../css/partial/header.css">
<link rel="stylesheet" href="../../../../css/partial/archives.css">
<link rel="stylesheet" href="../../../../css/partial/categories.css">
<link rel="stylesheet" href="../../../../css/partial/home-posts.css">
<link rel="stylesheet" href="../../../../css/partial/page-nav.css">
<link rel="stylesheet" href="../../../../css/partial/tags.css">
<link rel="stylesheet" href="../../../../css/partial/about.css">
<link rel="stylesheet" href="../../../../css/partial/more.css">
<link rel="stylesheet" href="../../../../css/partial/footer.css">
<link rel="stylesheet" href="../../../../css/post.css">
<link rel="stylesheet" href="../../../../css/orgmode/hexo_orgmode_style.css">


<!--javascript-->
<!--script type="text/javascript" src="/script.js"></script-->
<script src="../../../../lib/jquery-1.11.3.min.js"></script>
<script src="../../../../js/common.js"></script>
<script src="../../../../js/nav.js"></script>

  </head>
  <body>
    <main class="main">
      <table class="container">
    <tbody id="tb_container">
        <tr id="tr_navbar">
            <script src="js/nav.js"></script>
<table class="navbar">
	<tbody>
		<tr>
			<th class="navitm">
				<a href="../../../../index.html">主页</a>
			</th>

			<th class="navitm">
				<a href="../../../../categories">分类</a>
				<div id="category_menus" class="second">
					
					<!--合并内部类和自定义类。
    每个分类的数据结构包括：
    id: 分类唯一id
    title: 分类名
    parent: 父分类id
    children:子分类数组
注：
内部类包含一个固定的分类结type="text/javascript"内部根分类设置为categories, title为分类在主题config.yml中有配置（待定）。
后续文章中设置的分类如果不是内部类都会被称作自定义类，可以通过hexo本身引擎检测出来。
最终内部类和自定义类会合并到完整分类(full_categories)中，这样让所有类能用json等通用方式表示，便于移植。

使用举例：
var category_info = getCategoriesInfo();
<x var symbols={}; x> //定义导出变量
<x- include('category_list', {symbols:symbols}) x> //包含该文件
<x var category_info = symbols.getCategoriesInfo(); x> //获取分类信息：包含分类树，以及分类与文章数映射表。
<x- symbols.list_category(category_info.categories, category_info.categories_count) x> //列出分类索引树

注： '<x' 是EJS模板语言的标记比如x为%。
-->

					
					<ul id="full_categories_tree" class="categories_tree categories_level0" type="none"><li id="categories" class="categories_tree_item"><a href="../../../../categories/" class="item_path"><span id="categories_switch" class="tree_switch">▷</span><span id="categories_title" class="item_title">分类</span><span id="categories_count" class="item_count">(58)</span></a><ul id="categories_tree" class="categories_tree categories_level2" type="none"><li id="note" class="categories_tree_item"><a href="../../../../categories/categories/note" class="item_path"><span id="note_switch" class="tree_switch">▷</span><span id="note_title" class="item_title">记事</span><span id="note_count" class="item_count">(6)</span></a><ul id="note_tree" class="categories_tree categories_level3" type="none"><li id="remind" class="categories_tree_item"><a href="../../../../categories/categories/note/remind" class="item_path"><span id="remind_switch" class="tree_switch">○</span><span id="remind_title" class="item_title">备忘</span><span id="remind_count" class="item_count">(0)</span></a></li><li id="plan" class="categories_tree_item"><a href="../../../../categories/categories/note/plan" class="item_path"><span id="plan_switch" class="tree_switch">○</span><span id="plan_title" class="item_title">计划</span><span id="plan_count" class="item_count">(0)</span></a></li>|</ul></li><li id="study" class="categories_tree_item"><a href="../../../../categories/categories/study" class="item_path"><span id="study_switch" class="tree_switch">▷</span><span id="study_title" class="item_title">学习</span><span id="study_count" class="item_count">(2)</span></a><ul id="study_tree" class="categories_tree categories_level3" type="none"><li id="problem" class="categories_tree_item"><a href="../../../../categories/categories/study/problem" class="item_path"><span id="problem_switch" class="tree_switch">○</span><span id="problem_title" class="item_title">问题</span><span id="problem_count" class="item_count">(0)</span></a></li><li id="git" class="categories_tree_item"><a href="../../../../categories/categories/study/git" class="item_path"><span id="git_switch" class="tree_switch">○</span><span id="git_title" class="item_title">git</span><span id="git_count" class="item_count">(1)</span></a></li><li id="os" class="categories_tree_item"><a href="../../../../categories/categories/study/os" class="item_path"><span id="os_switch" class="tree_switch">○</span><span id="os_title" class="item_title">操作系统</span><span id="os_count" class="item_count">(1)</span></a></li><li id="books" class="categories_tree_item"><a href="../../../../categories/categories/study/books" class="item_path"><span id="books_switch" class="tree_switch">▷</span><span id="books_title" class="item_title">books</span><span id="books_count" class="item_count">(0)</span></a><ul id="books_tree" class="categories_tree categories_level4" type="none"><li id="apue" class="categories_tree_item"><a href="../../../../categories/categories/study/books/apue" class="item_path"><span id="apue_switch" class="tree_switch">○</span><span id="apue_title" class="item_title">APUE</span><span id="apue_count" class="item_count">(0)</span></a></li>|</ul></li><li id="linux" class="categories_tree_item"><a href="../../../../categories/categories/study/linux" class="item_path"><span id="linux_switch" class="tree_switch">▷</span><span id="linux_title" class="item_title">linux</span><span id="linux_count" class="item_count">(3)</span></a><ul id="linux_tree" class="categories_tree categories_level4" type="none"><li id="misc" class="categories_tree_item"><a href="../../../../categories/categories/study/linux/misc" class="item_path"><span id="misc_switch" class="tree_switch">○</span><span id="misc_title" class="item_title">杂乱</span><span id="misc_count" class="item_count">(3)</span></a></li><li id="command" class="categories_tree_item"><a href="../../../../categories/categories/study/linux/command" class="item_path"><span id="command_switch" class="tree_switch">○</span><span id="command_title" class="item_title">命令</span><span id="command_count" class="item_count">(19)</span></a></li>|</ul></li><li id="jekyll" class="categories_tree_item"><a href="../../../../categories/categories/study/jekyll" class="item_path"><span id="jekyll_switch" class="tree_switch">○</span><span id="jekyll_title" class="item_title">jekyll</span><span id="jekyll_count" class="item_count">(0)</span></a></li><li id="kits" class="categories_tree_item"><a href="../../../../categories/categories/study/kits" class="item_path"><span id="kits_switch" class="tree_switch">○</span><span id="kits_title" class="item_title">工具</span><span id="kits_count" class="item_count">(1)</span></a></li><li id="emacs" class="categories_tree_item"><a href="../../../../categories/categories/study/emacs" class="item_path"><span id="emacs_switch" class="tree_switch">○</span><span id="emacs_title" class="item_title">emacs</span><span id="emacs_count" class="item_count">(2)</span></a></li><li id="vim" class="categories_tree_item"><a href="../../../../categories/categories/study/vim" class="item_path"><span id="vim_switch" class="tree_switch">○</span><span id="vim_title" class="item_title">vim</span><span id="vim_count" class="item_count">(0)</span></a></li>|</ul></li><li id="work" class="categories_tree_item"><a href="../../../../categories/categories/work" class="item_path"><span id="work_switch" class="tree_switch">▷</span><span id="work_title" class="item_title">工作</span><span id="work_count" class="item_count">(0)</span></a><ul id="work_tree" class="categories_tree categories_level3" type="none"><li id="progress" class="categories_tree_item"><a href="../../../../categories/categories/work/progress" class="item_path"><span id="progress_switch" class="tree_switch">○</span><span id="progress_title" class="item_title">进度</span><span id="progress_count" class="item_count">(0)</span></a></li>|</ul></li><li id="life" class="categories_tree_item"><a href="../../../../categories/categories/life" class="item_path"><span id="life_switch" class="tree_switch">▷</span><span id="life_title" class="item_title">生活</span><span id="life_count" class="item_count">(0)</span></a><ul id="life_tree" class="categories_tree categories_level3" type="none"><li id="experience" class="categories_tree_item"><a href="../../../../categories/categories/life/experience" class="item_path"><span id="experience_switch" class="tree_switch">○</span><span id="experience_title" class="item_title">经验</span><span id="experience_count" class="item_count">(0)</span></a></li><li id="tips" class="categories_tree_item"><a href="../../../../categories/categories/life/tips" class="item_path"><span id="tips_switch" class="tree_switch">○</span><span id="tips_title" class="item_title">技巧</span><span id="tips_count" class="item_count">(0)</span></a></li>|</ul></li><li id="others" class="categories_tree_item"><a href="../../../../categories/categories/others" class="item_path"><span id="others_switch" class="tree_switch">▷</span><span id="others_title" class="item_title">其它</span><span id="others_count" class="item_count">(4)</span></a><ul id="others_tree" class="categories_tree categories_level3" type="none"><li id="rambles" class="categories_tree_item"><a href="../../../../categories/categories/others/rambles" class="item_path"><span id="rambles_switch" class="tree_switch">○</span><span id="rambles_title" class="item_title">随笔</span><span id="rambles_count" class="item_count">(0)</span></a></li><li id="temp" class="categories_tree_item"><a href="../../../../categories/categories/others/temp" class="item_path"><span id="temp_switch" class="tree_switch">○</span><span id="temp_title" class="item_title">临时</span><span id="temp_count" class="item_count">(0)</span></a></li><li id="test" class="categories_tree_item"><a href="../../../../categories/categories/others/test" class="item_path"><span id="test_switch" class="tree_switch">○</span><span id="test_title" class="item_title">测试</span><span id="test_count" class="item_count">(0)</span></a></li>|</ul></li>|</ul></li></ul>
				</div>
			</th>

			<th class="navblank"></th>

			<th class="navitm">
				<a href="../../../../tags">标签</a>
				<div id="tag_menus" class="second">
					<ul class="tag-list"></ul>
				</div>
			</th>

			<th class="navitm">
				<a href="../../../../archives">归档</a>
			</th>

			<th class="navblank"></th>

			<th class="navitm">
				<a href="../../../../more">更多</a>
			</th>

			<th class="navitm">
				<a href="../../../../about">关于</a>
			</th>

			<th class="navblank" style="width:25%;"></th>

			<th class="navitm" style="margin:0; padding:0;border:none;">
				<form method="get" id="searchform" action="/search.html" style="margin:0;padding:0;height:100%;">
					<span style="color:#00FF00;">Q</span>
					<span style="border-style:solid; border-width:1px; border-color:#00FF00;
		  		border-top:0px; border-left:0px;border-right:0px; 
				margin:0;padding:0;height:100%;">
						<input value="Search by title (canbe regex)..." name="s" class="s" onfocus="if (this.value == 'Search by title (canbe regex)...') {this.value = '';}" onblur="if (this.value == '') {this.value = 'Search by title (canbe regex)...';}" style="margin:0;padding:0;height:100%;border:none;background: #000000; color:#00A600;" type="text">
					</span>
					<!--input type="submit" value="Q" style="width:20%;"-->
				</form>
			</th>

			<th class="navblank"></th>

			<th class="navblank"></th>

			<a href="#" id="topbtn">⇑</a>

			<a href="#bottom" id="bottombtn">⇓</a>
			<!--⇐⇑⇒⇓-->
		</tr><tr>
	</tr></tbody>
</table>
        </tr>
        <tr>
            <td id="td_page_header" colspan="6" valign="top" align="right" style="width:100%;">
        <header style="text-align: center;">
               <a href="/" title="Menu.Home">
               <h1>QuietHeart's Site</h1>
               </a>
        </header>
</td>    
        </tr>
        <tr>
            <td id="td_posts" colspan="6" valign="top">
                <h1 id="header1" style="text-align: center;">
                    Linux命令学习手册-sed
                </h1>
                <hr id="title_line">
                <article>
                    <div>
                        <p>
参考资料：《鸟哥的私房菜》
</p>

<p>
<a href="http://linux-vbird.bluedata.org/linux_base/0330regularex.htm#basic_regexp_char" target="_blank" rel="noopener">http://linux-vbird.bluedata.org/linux_base/0330regularex.htm#basic_regexp_char</a>
</p>


<p>
sed [-nefr] [动作]
</p>

<p>
【功能】sed 可以分析处理标准输入的数据， 然后将它们输出到标准输出。可进行的处理包括取代、删除、新增、撷取特定行等等。
</p>


<p>
【举例】
</p>

<p>
例1：将 /etc/passwd 的内容列出，并且需要打印行号，同时，将第 3~28行删除：
</p>

<p>
$ nl /etc/passwd |sed '3,28d'
</p>

<p>
输入之后，产生如下输出：
</p>

<p>
1  root:x:0:0:root:/root:/bin/bash
</p>

<p>
2  daemon:x:1:1:daemon:/usr/sbin:/bin/sh
</p>

<p>
29  polkituser:x:107:115:PolicyKit,,,:/var/run/PolicyKit:/bin/false
</p>

<p>
30  haldaemon:x:108:116:Hardware abstraction layer,,,:/var/run/hald:/bin/false
</p>

<p>
31  gdm:x:109:117:Gnome Display Manager:/var/lib/gdm:/bin/false
</p>

<p>
注意：
</p>

<p>
1）原本应该是sed -e 才对，这里没-e 也行。
</p>

<p>
2）sed 后面接的动作，必须用 '' 两个单引号括住。
</p>


<p>
例2：将 /etc/passwd 的内容列出，并且需要打印行号，同时，将第 3行删除：
</p>

<p>
$nl /etc/passwd | sed '3d'
</p>

<p>
输出将不显示第3行由于篇幅，就省略了。
</p>


<p>
例3：将 /etc/passwd 的内容列出，并且需要打印行号，同时，将第3行到最后一行删除：
</p>

<p>
$nl /etc/passwd | sed '3,$d'
</p>

<p>
输入之后，输出如下：
</p>

<p>
1  root:x:0:0:root:/root:/bin/bash
</p>

<p>
2  daemon:x:1:1:daemon:/usr/sbin:/bin/sh
</p>



<p>
例4：在例1的基础上，在第2行后(亦即是加在第3行)加上『drink tea?』字样：
</p>

<p>
$nl /etc/passwd |sed '3,28d'|sed '2a drink tea'
</p>

<p>
输入之后，输出如下：
</p>

<p>
1  root:x:0:0:root:/root:/bin/bash
</p>

<p>
2  daemon:x:1:1:daemon:/usr/sbin:/bin/sh
</p>

<p>
drink tea
</p>

<p>
29  polkituser:x:107:115:PolicyKit,,,:/var/run/PolicyKit:/bin/false
</p>

<p>
30  haldaemon:x:108:116:Hardware abstraction layer,,,:/var/run/hald:/bin/false
</p>

<p>
31  gdm:x:109:117:Gnome Display Manager:/var/lib/gdm:/bin/false
</p>


<p>
例5：在例1的基础上，在第2行前(亦即是加在第2行)加上『drink tea?』字样：
</p>

<p>
$ nl /etc/passwd |sed '3,28d'|sed '2i drink tea'
</p>

<p>
输入之后，输出如下：
</p>

<p>
1  root:x:0:0:root:/root:/bin/bash
</p>

<p>
drink tea
</p>

<p>
2  daemon:x:1:1:daemon:/usr/sbin:/bin/sh
</p>

<p>
29  polkituser:x:107:115:PolicyKit,,,:/var/run/PolicyKit:/bin/false
</p>

<p>
30  haldaemon:x:108:116:Hardware abstraction layer,,,:/var/run/hald:/bin/false
</p>

<p>
31  gdm:x:109:117:Gnome Display Manager:/var/lib/gdm:/bin/false
</p>



<p>
例6：在/etc/passwd 的第2行后面加入2行字，例如『Drink tea or &#x2026;..』『drink beer?』:
</p>

<p>
$nl /etc/passwd | sed '2a Drink tea or &#x2026;&#x2026;\
</p>

<p>
&gt; drink beer ?'
</p>

<p>
输入之后，输出如下：
</p>

<p>
1  root:x:0:0:root:/root:/bin/bash
</p>

<p>
2  bin:x:1:1:bin:/bin:/sbin/nologin
</p>

<p>
Drink tea or &#x2026;&#x2026;
</p>

<p>
drink beer ?
</p>

<p>
3  daemon:x:2:2:daemon:/sbin:/sbin/nologin
</p>

<p>
&#x2026;后面内容由于篇幅原因省略&#x2026;
</p>

<p>
注意这里，'\'后面要紧接着回车才行。我们可以新增不只一行,但是每一行之间都必须要以反斜线 \ 来
</p>


<p>
进行新行的增加。
</p>


<p>
例7:将/etc/passwd 的第3-28行的内容取代成为『No 3-28 number』:
</p>

<p>
$nl /etc/passwd | sed '3,28c No 3-28 number'
</p>

<p>
输入之后，输出如下：
</p>

<p>
1  root:x:0:0:root:/root:/bin/bash
</p>

<p>
2  daemon:x:1:1:daemon:/usr/sbin:/bin/sh
</p>

<p>
No 3-28 number
</p>

<p>
29  polkituser:x:107:115:PolicyKit,,,:/var/run/PolicyKit:/bin/false
</p>

<p>
30  haldaemon:x:108:116:Hardware abstraction layer,,,:/var/run/hald:/bin/false
</p>

<p>
31  gdm:x:109:117:Gnome Display Manager:/var/lib/gdm:/bin/false
</p>



<p>
例8：仅列出/etc/passwd 的第 5-7 行：
</p>

<p>
$nl /etc/passwd | sed -n '5,7p'
</p>

<p>
输入之后，输出如下：
</p>

<p>
5  lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
</p>

<p>
6  sync:x:5:0:sync:/sbin:/bin/sync
</p>

<p>
7  shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
</p>

<p>
注意，一定要加上'-n'参数，否则输出如下：
</p>

<p>
1  root:x:0:0:root:/root:/bin/bash
</p>

<p>
2  daemon:x:1:1:daemon:/usr/sbin:/bin/sh
</p>

<p>
&#x2026;由于篇幅原因，省略&#x2026;
</p>

<p>
5  lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
</p>

<p>
5  lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
</p>

<p>
6  sync:x:5:0:sync:/sbin:/bin/sync
</p>

<p>
6  sync:x:5:0:sync:/sbin:/bin/sync
</p>

<p>
7  shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
</p>

<p>
7  shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
</p>

<p>
8  polkituser:x:107:115:PolicyKit,,,:/var/run/PolicyKit:/bin/false
</p>

<p>
&#x2026;由于篇幅原因，省略&#x2026;
</p>

<p>
由此可知，'-n'选项使得仅显示sed处理过的行。
</p>


<p>
例9：仅显示ifconfig结果中eth0的IP：
</p>

<p>
设命令"$ifconfig"的输出如下：
</p>

<p>
eth0      Link encap:Ethernet  HWaddr 00:51:FD:52:9A:CA
</p>

<p>
inet addr:192.168.1.12  Bcast:192.168.1.255  Mask:255.255.255.0
</p>

<p>
inet6 addr: fe80::250:fcff:fe22:9acb/64 Scope:Link
</p>

<p>
UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
</p>

<p>
那么我们用以下输入：
</p>

<p>
$ifconfig eth0|grep 'inet'|sed 's/^.*addr://g'|sed 's/Bcast.*$//g'
</p>

<p>
输入之后，输出如下：
</p>

<p>
192.168.1.12  
</p>

<p>
这里，将每个管线 '|' 的过程都分开来执行，(1)先用ifconfig eth0列出输出(2)用grep获得有inet的行
</p>


<p>
(3)用sed 's/^.*addr://g'把grep获得的行去掉ip地址前面的部分(4)用sed 's/Bcast.*$//g'去掉ip地址后面的部分。
</p>


<p>
例10：将 /etc/man.config 档案的内容中，有 MAN 的设定就取出来，但不要说明内容：
</p>

<p>
$cat /etc/man.config | grep 'MAN'| sed 's/#.*$//g' |sed '/^$/d'
</p>

<p>
注意，每一行当中，若有 # 表示该行为批注，但是要注意的是，有时候，批注并不是写在第一个字符，亦即是写在某个指令后方，如下的模样：『shutdown -h now # 这个是关机的指令』，批注 # 就在指令的后方了。因此，我们才会使用到将 #.*$ 这个正规表示法。sed '/^$d'是什么意思???????
</p>


<p>
例11：利用 sed 直接在 ~/.bashrc 最后一行加入『# This is a test』
</p>

<p>
sed -i '$a # This is a test'  ~/.bashrc
</p>

<p>
注意：-i 参数可以让你的 sed 直接去修改后面接的档案内容，$a  则代表最后一行才新增的意思,结果导致新增一行，如果没有-i，则将~/.bashrc全部显示并追加#This is a test，但是并不改变文件内容。
</p>



<p>
【描述】
</p>

<p>
参数：
</p>

<p>
-n  ：使用安静(silent)模式。在一般 sed 的用法中，所有来自 STDIN的数据一般都会被列出到屏幕上。但如果加上 -n 参数后，则只有经过sed 特殊处理的那一行(或者动作)才会被列出来。(见例8)
</p>

<p>
-e  ：直接在指令列模式上进行 sed 的动作编辑；
</p>

<p>
-f  ：直接将 sed 的动作写在一个档案内, -f filename 则可以执行 filename 内的sed 动作；
</p>

<p>
-r  ：sed 的动作支持的是延伸型正规表示法的语法。(预设是基础正规表示法语法)
</p>

<p>
-i  ：直接修改读取的档案内容，而不是由屏幕输出(见例11)。
</p>


<p>
动作说明：  [n1[,n2]]function
</p>

<p>
n1, n2 ：不见得会存在，一般代表『选择进行动作的行数』，举例来说，如果我的动作是需要在 10 到 20 行之间进行的，则『 10,20[动作行为] 』
</p>

<p>
function 有底下这些：
</p>

<p>
a   ：新增， a 的后面可以接字符串，而这些字符串会在新的一行出现(目前的下一行)。
</p>

<p>
c   ：取代， c 的后面可以接字符串，这些字符串可以取代 n1,n2 之间的行！
</p>

<p>
d   ：删除，因为是删除啊，所以 d 后面通常不接任何字符；
</p>

<p>
i   ：插入， i 的后面可以接字符串，而这些字符串会在新的一行出现(目前的上一行)；
</p>

<p>
p   ：打印，亦即将某个选择的数据印出。通常 p 会与参数 sed -n 一起运作。(见例8)
</p>

<p>
s   ：取代，可以直接进行取代的工作哩！通常这个 s 的动作可以搭配正规表示法！例如 1,20s/old/new/g 。
</p>

                    </div>
                </article>                        
                
                <!--{% include duoshuo_comment.ext %}-->
            </td>
        </tr>
        <tr>
            <td id="td_page_footer" colspan="6">
    <footer>
        &copy 2015
    </footer>
    <a id="bottom"></a>
</td>
        </tr>
    </tbody>
</table>
    </main>
  </body>
</html>