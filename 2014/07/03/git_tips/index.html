<!DOCTYPE html>
<html>
  <head><meta name="generator" content="Hexo 3.9.0">
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
<title>
    Git学习笔记
</title>

<!--css-->
<!--link rel="stylesheet" href="/style.css" type="text/css" /-->
<link rel="stylesheet" href="../../../../css/partial/head.css">
<link rel="stylesheet" href="../../../../css/partial/header.css">
<link rel="stylesheet" href="../../../../css/partial/archives.css">
<link rel="stylesheet" href="../../../../css/partial/categories.css">
<link rel="stylesheet" href="../../../../css/partial/home-posts.css">
<link rel="stylesheet" href="../../../../css/partial/page-nav.css">
<link rel="stylesheet" href="../../../../css/partial/tags.css">
<link rel="stylesheet" href="../../../../css/partial/about.css">
<link rel="stylesheet" href="../../../../css/partial/more.css">
<link rel="stylesheet" href="../../../../css/partial/footer.css">
<link rel="stylesheet" href="../../../../css/post.css">
<link rel="stylesheet" href="../../../../css/orgmode/hexo_orgmode_style.css">


<!--javascript-->
<!--script type="text/javascript" src="/script.js"></script-->
<script src="../../../../lib/jquery-1.11.3.min.js"></script>
<script src="../../../../lib/typelighter.min.js"></script>
<script src="../../../../js/common.js"></script>
<script src="../../../../js/nav.js"></script>

  </head>
  <body>
    <main class="main">
      <table class="container">
    <tbody id="tb_container">
        <tr id="tr_navbar">
            <table class="navbar">
	<tbody>
		<tr>
			<th class="navitm">
				<a href="../../../../index.html">主页</a>
			</th>

			<th class="navitm">
				<a href="../../../../categories">分类</a>
				<div id="category_menus" class="second">
					
					<!--合并内部类和自定义类。
    每个分类的数据结构包括：
    id: 分类唯一id
    title: 分类名
    parent: 父分类id
    children:子分类数组
注：
内部类包含一个固定的分类结type="text/javascript"内部根分类设置为categories, title为分类在主题config.yml中有配置（待定）。
后续文章中设置的分类如果不是内部类都会被称作自定义类，可以通过hexo本身引擎检测出来。
最终内部类和自定义类会合并到完整分类(full_categories)中，这样让所有类能用json等通用方式表示，便于移植。

使用举例：
var category_info = getCategoriesInfo();
<x var symbols={}; x> //定义导出变量
<x- include('category_list', {symbols:symbols}) x> //包含该文件
<x var category_info = symbols.getCategoriesInfo(); x> //获取分类信息：包含分类树，以及分类与文章数映射表。
<x- symbols.list_category(category_info.categories, category_info.categories_count) x> //列出分类索引树

注： '<x' 是EJS模板语言的标记比如x为%。
-->

					
					<ul id="full_categories_tree" class="categories_tree categories_level0" type="none"><li id="categories" class="categories_tree_item"><a href="../../../../categories/" class="item_path"><span id="categories_switch" class="tree_switch">▷</span><span id="categories_title" class="item_title">分类</span><span id="categories_count" class="item_count">(60)</span></a><ul id="categories_tree" class="categories_tree categories_level2" type="none"><li id="note" class="categories_tree_item"><a href="../../../../categories/categories/note" class="item_path"><span id="note_switch" class="tree_switch">▷</span><span id="note_title" class="item_title">记事</span><span id="note_count" class="item_count">(8)</span></a><ul id="note_tree" class="categories_tree categories_level3" type="none"><li id="remind" class="categories_tree_item"><a href="../../../../categories/categories/note/remind" class="item_path"><span id="remind_switch" class="tree_switch">○</span><span id="remind_title" class="item_title">备忘</span><span id="remind_count" class="item_count">(0)</span></a></li><li id="plan" class="categories_tree_item"><a href="../../../../categories/categories/note/plan" class="item_path"><span id="plan_switch" class="tree_switch">○</span><span id="plan_title" class="item_title">计划</span><span id="plan_count" class="item_count">(0)</span></a></li>|</ul></li><li id="study" class="categories_tree_item"><a href="../../../../categories/categories/study" class="item_path"><span id="study_switch" class="tree_switch">▷</span><span id="study_title" class="item_title">学习</span><span id="study_count" class="item_count">(6)</span></a><ul id="study_tree" class="categories_tree categories_level3" type="none"><li id="problem" class="categories_tree_item"><a href="../../../../categories/categories/study/problem" class="item_path"><span id="problem_switch" class="tree_switch">○</span><span id="problem_title" class="item_title">问题</span><span id="problem_count" class="item_count">(0)</span></a></li><li id="git" class="categories_tree_item"><a href="../../../../categories/categories/study/git" class="item_path"><span id="git_switch" class="tree_switch">○</span><span id="git_title" class="item_title">git</span><span id="git_count" class="item_count">(1)</span></a></li><li id="os" class="categories_tree_item"><a href="../../../../categories/categories/study/os" class="item_path"><span id="os_switch" class="tree_switch">○</span><span id="os_title" class="item_title">操作系统</span><span id="os_count" class="item_count">(1)</span></a></li><li id="books" class="categories_tree_item"><a href="../../../../categories/categories/study/books" class="item_path"><span id="books_switch" class="tree_switch">▷</span><span id="books_title" class="item_title">books</span><span id="books_count" class="item_count">(0)</span></a><ul id="books_tree" class="categories_tree categories_level4" type="none"><li id="apue" class="categories_tree_item"><a href="../../../../categories/categories/study/books/apue" class="item_path"><span id="apue_switch" class="tree_switch">○</span><span id="apue_title" class="item_title">APUE</span><span id="apue_count" class="item_count">(0)</span></a></li>|</ul></li><li id="linux" class="categories_tree_item"><a href="../../../../categories/categories/study/linux" class="item_path"><span id="linux_switch" class="tree_switch">▷</span><span id="linux_title" class="item_title">linux</span><span id="linux_count" class="item_count">(6)</span></a><ul id="linux_tree" class="categories_tree categories_level4" type="none"><li id="misc" class="categories_tree_item"><a href="../../../../categories/categories/study/linux/misc" class="item_path"><span id="misc_switch" class="tree_switch">○</span><span id="misc_title" class="item_title">杂乱</span><span id="misc_count" class="item_count">(3)</span></a></li><li id="command" class="categories_tree_item"><a href="../../../../categories/categories/study/linux/command" class="item_path"><span id="command_switch" class="tree_switch">○</span><span id="command_title" class="item_title">命令</span><span id="command_count" class="item_count">(19)</span></a></li>|</ul></li><li id="jekyll" class="categories_tree_item"><a href="../../../../categories/categories/study/jekyll" class="item_path"><span id="jekyll_switch" class="tree_switch">○</span><span id="jekyll_title" class="item_title">jekyll</span><span id="jekyll_count" class="item_count">(0)</span></a></li><li id="kits" class="categories_tree_item"><a href="../../../../categories/categories/study/kits" class="item_path"><span id="kits_switch" class="tree_switch">○</span><span id="kits_title" class="item_title">工具</span><span id="kits_count" class="item_count">(1)</span></a></li><li id="emacs" class="categories_tree_item"><a href="../../../../categories/categories/study/emacs" class="item_path"><span id="emacs_switch" class="tree_switch">○</span><span id="emacs_title" class="item_title">emacs</span><span id="emacs_count" class="item_count">(2)</span></a></li><li id="vim" class="categories_tree_item"><a href="../../../../categories/categories/study/vim" class="item_path"><span id="vim_switch" class="tree_switch">○</span><span id="vim_title" class="item_title">vim</span><span id="vim_count" class="item_count">(0)</span></a></li>|</ul></li><li id="work" class="categories_tree_item"><a href="../../../../categories/categories/work" class="item_path"><span id="work_switch" class="tree_switch">▷</span><span id="work_title" class="item_title">工作</span><span id="work_count" class="item_count">(0)</span></a><ul id="work_tree" class="categories_tree categories_level3" type="none"><li id="progress" class="categories_tree_item"><a href="../../../../categories/categories/work/progress" class="item_path"><span id="progress_switch" class="tree_switch">○</span><span id="progress_title" class="item_title">进度</span><span id="progress_count" class="item_count">(0)</span></a></li>|</ul></li><li id="life" class="categories_tree_item"><a href="../../../../categories/categories/life" class="item_path"><span id="life_switch" class="tree_switch">▷</span><span id="life_title" class="item_title">生活</span><span id="life_count" class="item_count">(0)</span></a><ul id="life_tree" class="categories_tree categories_level3" type="none"><li id="experience" class="categories_tree_item"><a href="../../../../categories/categories/life/experience" class="item_path"><span id="experience_switch" class="tree_switch">○</span><span id="experience_title" class="item_title">经验</span><span id="experience_count" class="item_count">(0)</span></a></li><li id="tips" class="categories_tree_item"><a href="../../../../categories/categories/life/tips" class="item_path"><span id="tips_switch" class="tree_switch">○</span><span id="tips_title" class="item_title">技巧</span><span id="tips_count" class="item_count">(0)</span></a></li>|</ul></li><li id="others" class="categories_tree_item"><a href="../../../../categories/categories/others" class="item_path"><span id="others_switch" class="tree_switch">▷</span><span id="others_title" class="item_title">其它</span><span id="others_count" class="item_count">(4)</span></a><ul id="others_tree" class="categories_tree categories_level3" type="none"><li id="rambles" class="categories_tree_item"><a href="../../../../categories/categories/others/rambles" class="item_path"><span id="rambles_switch" class="tree_switch">○</span><span id="rambles_title" class="item_title">随笔</span><span id="rambles_count" class="item_count">(0)</span></a></li><li id="temp" class="categories_tree_item"><a href="../../../../categories/categories/others/temp" class="item_path"><span id="temp_switch" class="tree_switch">○</span><span id="temp_title" class="item_title">临时</span><span id="temp_count" class="item_count">(0)</span></a></li><li id="test" class="categories_tree_item"><a href="../../../../categories/categories/others/test" class="item_path"><span id="test_switch" class="tree_switch">○</span><span id="test_title" class="item_title">测试</span><span id="test_count" class="item_count">(0)</span></a></li>|</ul></li>|</ul></li></ul>
				</div>
			</th>

			<th class="navblank"></th>

			<th class="navitm">
				<a href="../../../../tags">标签</a>
				<div id="tag_menus" class="second">
					<ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/gtd-next/">gtd_next</a><span class="tag-list-count">1</span></li></ul>
				</div>
			</th>

			<th class="navitm">
				<a href="../../../../archives">归档</a>
			</th>

			<th class="navblank"></th>

			<th class="navitm">
				<a href="../../../../more">更多</a>
			</th>

			<th class="navitm">
				<a href="../../../../about">关于</a>
			</th>

			<th class="navblank" style="width:25%;"></th>

			<th class="navitm" style="margin:0; padding:0;border:none;">
				<form method="get" id="searchform" action="/search.html" style="margin:0;padding:0;height:100%;">
					<span style="color:#00FF00;">Q</span>
					<span style="border-style:solid; border-width:1px; border-color:#00FF00;
		  		border-top:0px; border-left:0px;border-right:0px; 
				margin:0;padding:0;height:100%;">
						<input value="Search by title (canbe regex)..." name="s" class="s" onfocus="if (this.value == 'Search by title (canbe regex)...') {this.value = '';}" onblur="if (this.value == '') {this.value = 'Search by title (canbe regex)...';}" style="margin:0;padding:0;height:100%;border:none;background: #000000; color:#00A600;" type="text">
					</span>
					<!--input type="submit" value="Q" style="width:20%;"-->
				</form>
			</th>

			<th class="navblank"></th>

			<th class="navblank"></th>

			<a href="#" id="topbtn">⇑</a>

			<a href="#bottom" id="bottombtn">⇓</a>
			<!--⇐⇑⇒⇓-->
		</tr><tr>
	</tr></tbody>
</table>
        </tr>
        <tr>
            <td id="td_page_header" colspan="6" valign="top" align="right" style="width:100%;">
        <header style="text-align: center;">
               <a href="/" title="Menu.Home">
               <h1>QuietHeart's Site</h1>
               </a>
        </header>
</td>    
        </tr>
        <tr>
            <td id="td_posts" colspan="6" valign="top">
                <h1 id="header1" style="text-align: center;">
                    Git学习笔记
                </h1>
                <hr id="title_line">
                <article>
                    <div>
                        <div id="table-of-contents">
<h2>&#30446;&#24405;</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgheadline1">1. 简介</a></li>
<li><a href="#orgheadline2">2. 基本</a>
<ul>
<li><a href="#orgheadline3">2.1. 初始化操作  <code>git init</code></a>
<ul>
<li><a href="#orgheadline4">2.1.1. 基本语法</a></li>
<li><a href="#orgheadline5">2.1.2. 常用操作</a></li>
</ul>
</li>
<li><a href="#orgheadline6">2.2. 克隆操作 <code>git clone</code></a>
<ul>
<li><a href="#orgheadline7">2.2.1. 常用操作</a></li>
</ul>
</li>
<li><a href="#orgheadline8">2.3. 分支操作 <code>git branch</code></a>
<ul>
<li><a href="#orgheadline9">2.3.1. 基本语法</a></li>
<li><a href="#orgheadline10">2.3.2. <span class="todo nilNEXT">NEXT</span> 常用操作</a></li>
</ul>
</li>
<li><a href="#orgheadline11">2.4. 检出操作 <code>git checkout</code></a></li>
<li><a href="#orgheadline12">2.5. 合并操作 <code>git merge</code></a></li>
<li><a href="#orgheadline13">2.6. 标签操作 <code>git tag</code></a></li>
<li><a href="#orgheadline14">2.7. 配置操作 <code>git config</code></a>
<ul>
<li><a href="#orgheadline15">2.7.1. 列出配置内容</a></li>
<li><a href="#orgheadline16">2.7.2. 配置默认编辑器</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgheadline17">3. 远程同步与协作</a>
<ul>
<li><a href="#orgheadline18">3.1. 更新分支 <code>git rebase</code></a>
<ul>
<li><a href="#orgheadline19">3.1.1. 只有本地库</a></li>
<li><a href="#orgheadline20">3.1.2. pull</a></li>
<li><a href="#orgheadline21">3.1.3. 有冲突时</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgheadline22">4. 获取当前库信息</a></li>
<li><a href="#orgheadline23">5. FAQ <code>[10%]</code><code>[2/20]</code></a>
<ul>
<li><a href="#orgheadline24">5.1. <span class="todo nilNEXT">NEXT</span> git describe</a></li>
<li><a href="#orgheadline25">5.2. <span class="todo nilNEXT">NEXT</span> git log</a>
<ul>
<li><a href="#orgheadline26">5.2.1. &#x2013;decorate</a></li>
<li><a href="#orgheadline27">5.2.2. 查看某两个tag/commit之间的log</a></li>
<li><a href="#orgheadline28">5.2.3. 格式化的输出</a></li>
<li><a href="#orgheadline29">5.2.4. 查看日志同时也显示具体修改的文件</a></li>
<li><a href="#orgheadline30">5.2.5. 待阅</a></li>
</ul>
</li>
<li><a href="#orgheadline31">5.3. <span class="todo nilNEXT">NEXT</span> git revert</a></li>
<li><a href="#orgheadline32">5.4. <span class="todo nilNEXT">NEXT</span> git remote</a></li>
<li><a href="#orgheadline33">5.5. <span class="todo nilLATER">LATER</span> git grep等搜索方式</a></li>
<li><a href="#orgheadline34">5.6. <span class="todo nilLATER">LATER</span> git对链接文件的管理</a></li>
<li><a href="#orgheadline35">5.7. <span class="todo nilWAIT_FORWARD">WAIT/FORWARD</span> git commit</a></li>
<li><a href="#orgheadline36">5.8. <span class="todo nilWAIT_FORWARD">WAIT/FORWARD</span> git如何管理软链接？</a>
<ul>
<li><a href="#orgheadline37">5.8.1. 软链接</a></li>
<li><a href="#orgheadline38">5.8.2. 硬链接</a></li>
</ul>
</li>
<li><a href="#orgheadline39">5.9. <span class="todo nilLATER">LATER</span> git submodule研究</a></li>
<li><a href="#orgheadline40">5.10. <span class="todo nilLATER">LATER</span> git的push和pull如何实现免密码？</a></li>
<li><a href="#orgheadline41">5.11. <span class="todo nilLATER">LATER</span> git push技巧</a></li>
<li><a href="#orgheadline42">5.12. <span class="todo nilWAIT_FORWARD">WAIT/FORWARD</span> <code>.gitignore</code> 中列出的文件在 <code>git add</code> 之后，就不管用了。</a></li>
<li><a href="#orgheadline43">5.13. <span class="todo nilWAIT_FORWARD">WAIT/FORWARD</span> git dir</a></li>
<li><a href="#orgheadline44">5.14. <span class="todo nilLATER">LATER</span> 理解git原理的关键</a>
<ul>
<li><a href="#orgheadline45">5.14.1. 分布式的理解</a></li>
<li><a href="#orgheadline46">5.14.2. 工作流程、状态</a></li>
<li><a href="#orgheadline47">5.14.3. 工作空间(work area)、缓存空间(staged area)、库(repository)</a></li>
<li><a href="#orgheadline48">5.14.4. 针对 <code>git</code> 的内容</a></li>
</ul>
</li>
<li><a href="#orgheadline49">5.15. <span class="todo nilNEXT">NEXT</span> git checkout 到一个 <code>git log</code> 中非HEAD的版本后，如何checkout回来？</a></li>
<li><a href="#orgheadline50">5.16. <span class="todo nilNEXT">NEXT</span> git reflog</a></li>
<li><a href="#orgheadline51">5.17. <span class="todo nilNEXT">NEXT</span> git mergebase ref1 ref2</a></li>
<li><a href="#orgheadline52">5.18. <span class="todo nilNEXT">NEXT</span> git shortlog</a></li>
<li><a href="#orgheadline53">5.19. 分支合并的一个例子</a>
<ul>
<li><a href="#orgheadline54">5.19.1. 先切换到新的分支上</a></li>
<li><a href="#orgheadline55">5.19.2. 确认修改工作所在路径的新旧分支公共的 <code>commit ID</code></a></li>
<li><a href="#orgheadline56">5.19.3. 修改工作目录切换到新FVP分支,并</a></li>
<li><a href="#orgheadline57">5.19.4. 记录新分支的HEAD</a></li>
<li><a href="#orgheadline58">5.19.5. 将旧分支工作合并到新分支</a></li>
</ul>
</li>
<li><a href="#orgheadline59">5.20. 回退与合并指定区间的例子</a>
<ul>
<li><a href="#orgheadline60">5.20.1. 确认 <code>b1</code> 与 <code>b2</code> 的共通祖先 <code>A</code></a></li>
<li><a href="#orgheadline61">5.20.2. 将 <code>b2</code> 回退到 <code>A</code></a></li>
<li><a href="#orgheadline62">5.20.3. 将 <code>A</code> 到 <code>b1*</code> 的修改应用到回退完的 <code>b2</code></a></li>
</ul>
</li>
<li><a href="#orgheadline63">5.21. <code>man gitignore</code></a></li>
<li><a href="#orgheadline64">5.22. git checkout 后退后，如何前进？</a></li>
<li><a href="#orgheadline65">5.23. <span class="done nilREFERENCE">REFERENCE</span> git 二分法定位问题</a>
<ul>
<li><a href="#orgheadline66">5.23.1. 过程</a></li>
<li><a href="#orgheadline67">5.23.2. 例子</a></li>
<li><a href="#orgheadline68">5.23.3. 参考：</a></li>
</ul>
</li>
<li><a href="#orgheadline69">5.24. <span class="done nilREFERENCE">REFERENCE</span> 使用 <code>git log</code> 或 <code>git rev-list</code> 根据作者和日期筛选提交</a>
<ul>
<li><a href="#orgheadline70">5.24.1. 举例（由来）</a></li>
</ul>
</li>
<li><a href="#orgheadline71">5.25. gerrit操作汇集</a>
<ul>
<li><a href="#orgheadline72">5.25.1. local</a></li>
<li><a href="#orgheadline73">5.25.2. remote</a></li>
</ul>
</li>
<li><a href="#orgheadline74">5.26. 找到丢失的历史</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-orgheadline1" class="outline-2">
<h2 id="orgheadline1"><span class="section-number-2">1</span> 简介</h2>
</div>
<div id="outline-container-orgheadline2" class="outline-2">
<h2 id="orgheadline2"><span class="section-number-2">2</span> 基本</h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-orgheadline3" class="outline-3">
<h3 id="orgheadline3"><span class="section-number-3">2.1</span> 初始化操作  <code>git init</code></h3>
<div class="outline-text-3" id="text-2-1">
</div><div id="outline-container-orgheadline4" class="outline-4">
<h4 id="orgheadline4"><span class="section-number-4">2.1.1</span> 基本语法</h4>
<div class="outline-text-4" id="text-2-1-1">
<pre class="example">
git init [-q | --quiet] [--bare] [--template=&lt;template_directory&gt;] [--separate-git-dir &lt;git dir&gt;] [--shared[=&lt;permissions&gt;]] [directory]
</pre>
</div>
</div>

<div id="outline-container-orgheadline5" class="outline-4">
<h4 id="orgheadline5"><span class="section-number-4">2.1.2</span> 常用操作</h4>
<div class="outline-text-4" id="text-2-1-2">
<ul class="org-ul">
<li><p>
创建纯库
</p>

<p>
输入 <code>$git init --bare</code>
</p>

<p>
这样会创建一个git库，只有库的内容，没有 <code>.git</code> 目录（也就是说只创建一个库，这个库中没有工作代码，只供别的人工作 <code>git clone</code> 用，如果没有 <code>--bare</code> 那么创建的目录中包含一个 <code>.git</code> 目录， <code>.git</code> 目录的内容是库内容）。实践发现，分别用两个目录同样的内容用 <code>git init</code> 创建库，两个库是不同的库，就算提交注释一样，文件目录一样，其commit id也不一样。但是， <code>git clone</code> 出来其中一个库之后，可以在clone的库中将 <code>.git/config</code> 中的源改成另外一个库，并且 <code>git pull</code> 。所以，假设我们在机器A上 <code>git init --bare</code> ，在机器B上 <code>git init</code> 并且提交了代码，将A添加到B的 <code>remote</code> 中，在B进行 <code>git push</code> ，这样机器A中之前的空库就有了B的提交内容。
</p></li>

<li><p>
创建共享库
</p>

<p>
输入 <code>$git init --share</code>
</p>

<p>
创建的git库可以被人共享。
</p></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orgheadline6" class="outline-3">
<h3 id="orgheadline6"><span class="section-number-3">2.2</span> 克隆操作 <code>git clone</code></h3>
<div class="outline-text-3" id="text-2-2">
</div><div id="outline-container-orgheadline7" class="outline-4">
<h4 id="orgheadline7"><span class="section-number-4">2.2.1</span> 常用操作</h4>
<div class="outline-text-4" id="text-2-2-1">
<ul class="org-ul">
<li><p>
复制库到本地
</p>

<p>
输入 <code>$git clone xxx</code>
</p>

<p>
这样会将 <code>xxx</code> 所指向的git库复制一份到本地。复制之后，本地包含两个部分：
</p>
<ol class="org-ol">
<li><code>.git</code> 目录中包含库信息。</li>
<li><code>.git</code> 外面的工作区。</li>
</ol>
<p>
其实 <code>.git</code> 就包含了所有的内容，我们传输文件时只需要目录中有一个 <code>.git</code> 目录，然后 <code>git reset --hard</code> 就可恢复出head对应的工作区内容。
</p>

<p>
注意，这里复制的库用 <code>git branch</code> 看不到远端（来源）的分支信息，想看远端的分支信息用 <code>git branch -a</code> 。详见 <code>git branch</code> 相关命令。
</p></li>

<li><p>
复制裸库，不含工作区
</p>

<p>
输入 <code>git clone --bare</code>
</p>

<p>
这里，我们使用 <code>git clone --bare</code> 只 <code>clone</code> 其中的 <code>.git</code> 目录，其余内容可以用 <code>git reset --hard</code> 在本地还原。对于本地的 <code>git clone</code> ，其实默认做的是硬链接，速度很快。对本地源库使用 <code>git clone --bare xxx</code> 可以发现 <code>.git</code> 会瞬间将 <code>xxx</code> 直接 <code>clone</code> 到当前目标目录的 <code>.git</code> 形成裸库，通过 <code>git reset --hard</code> 恢复其内容。
</p></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orgheadline8" class="outline-3">
<h3 id="orgheadline8"><span class="section-number-3">2.3</span> 分支操作 <code>git branch</code></h3>
<div class="outline-text-3" id="text-2-3">
</div><div id="outline-container-orgheadline9" class="outline-4">
<h4 id="orgheadline9"><span class="section-number-4">2.3.1</span> 基本语法</h4>
<div class="outline-text-4" id="text-2-3-1">
<pre class="example">
git branch [--color[=&lt;when&gt;] | --no-color] [-r | -a] [--list] [-v [--abbrev=&lt;length&gt; | --no-abbrev]] [(--merged | --no-merged | --contains) [&lt;commit&gt;]] [&lt;pattern&gt;...]
git branch [--set-upstream | --track | --no-track] [-l] [-f] &lt;branchname&gt; [&lt;start-point&gt;]
git branch (-m | -M) [&lt;oldbranch&gt;] &lt;newbranch&gt;
git branch (-d | -D) [-r] &lt;branchname&gt;...
git branch --edit-description [&lt;branchname&gt;]
</pre>
</div>
</div>

<div id="outline-container-orgheadline10" class="outline-4">
<h4 id="orgheadline10"><span class="section-number-4">2.3.2</span> <span class="todo NEXT">NEXT</span> 常用操作</h4>
<div class="outline-text-4" id="text-2-3-2">
<ul class="org-ul">
<li>State "NEXT"       from              <span class="timestamp-wrapper"><span class="timestamp">[2016-03-04 五 17:16]</span></span></li>
</ul>
<p>
*查看本地分支：
$git branch
会输出本地分支，如：
test
*master
这表示有一个master主分支，和test分支。master是默认的分支，当前所处分支用'*'标记，在master上。对于如何存储，可参见：.git/refs/head/&lt;分支名&gt;。
</p>

<p>
*查看远端分支：
$git branch -r
会输出远端（可能是多个远端）的分支，如：
cognac/master
origin/albert
这里，'/'前面是远端名，'/'后面是实际的分支。对于如何存储，可参见：.git/refs/remotes/&lt;远端分支名&gt;。
</p>

<p>
*查看本地和远端分支：
$git branch -a
同时查看远端和本地分支，远端分支以红色显示。
一般git clone之后，如果只用"git branch"则只能看到远端当前的分支，使用这个命令可以看到远端其他的分支，可以切换至这个分支，但如果想在其中进行工作，需要基于此分支创建一个本地的相应分支。
</p>

<p>
*创建分支：
$git branch &lt;branch name&gt;
</p>

<p>
*修改分支名称：
$git branch -m &lt;old name&gt; &lt;new name&gt;
注意，不要有已有的分支名冲突。
</p>

<p>
*基于远端分支创建相应的本地分支：
$git branch -track origin/albert
新版git不用-track选项，会根据远端分支名知道加上track选项，创建之后，相应的分支在本地创建，会与远端分支关联。这样pull会知道如何合并分支，以及获知各种其他远端跟踪的信息（如本地比远端多提交了几个版本等）。
</p>

<p>
*基于某个点创建分支：
git branch &lt;branch name&gt; &lt;start point&gt;
这里，branch name就是你的分支名，start point可以是一次提交，或者一个分支名等等，标识你的当前分支是基于此进行创建（衍生）的。
关于branch是基于哪个分支创建的，目前尚无方法，可以查看.git/config中，对应branch中的merge字段，知道merge的分支。
**
</p>

<p>
**checkout分支操作
git checkout [-q] [-f] [-m] [&lt;branch&gt;]
git checkout [-q] [-f] [-m] [[-b|-B|&#x2013;orphan] &lt;new_branch&gt;] [&lt;start_point&gt;]
</p>

<p>
*开始一个无历史的新分支:
$git checkout &#x2013;orphan &lt;branchname&gt;
创建一个孤儿分支，该分支上第一个提交历史没有任何父亲节点。这样可以开始一个新分支，但是又不会把很长很长的历史记录带进来，例如，你想在公众区域（开源）放置你的代码，但是又不想别人知道它的历史记录会用到这个。一般在孤儿分支中，如果你想创建一个完全无关的内容，那么第一步往往是把当前所有文件清空，这样这个分支就和其它分支没有任何关联了。
</p>

<p>
*创建分支并切换入新创建的分支：
$git checkout -b &lt;branch name&gt;
另外，如果是从remote获取的，本地无br1分支，那么可以用：git checkout -b br1 origin/xx/br1
</p>

<p>
*创建指定起点的分支：
$git checkout -b &lt;branch name&gt; &lt;start point&gt;
这里，start point指定分支是基于谁来创建的，可以是分支名，也可以是提交名。如果没有这个参数，默认以当前分支的head为分支起点。
</p>

<p>
*创建基于&lt;tag_xxxx&gt;的分支：
$git checkout -b my_branch &lt;tag_xxxx&gt; 
这样，会创建一个分支，该分支基于&lt;tag_xxxx&gt;。
**
</p>
</div>
</div>
</div>

<div id="outline-container-orgheadline11" class="outline-3">
<h3 id="orgheadline11"><span class="section-number-3">2.4</span> 检出操作 <code>git checkout</code></h3>
<div class="outline-text-3" id="text-2-4">
<p>
**checkout回复操作
*恢复之前的某次提交：
$git checkout &lt;commitid&gt;
这样，会将当前的HEAD指向&lt;commitid&gt;所处的提交，通过'git log'可发现，执行之后，log中commitid之后的提交消失了，但是如果记住&lt;commitid&gt;的话，可以将之前的HEAD回复，所以要注意checkout之后log无法找到之前的最新head。
</p>

<p>
*恢复之前的某次提交的某个目录：
$git checkout &lt;commitid&gt; &#x2013; &lt;dir&gt;
如果文件应该不需要"&#x2013;"。
**
</p>
</div>
</div>

<div id="outline-container-orgheadline12" class="outline-3">
<h3 id="orgheadline12"><span class="section-number-3">2.5</span> 合并操作 <code>git merge</code></h3>
<div class="outline-text-3" id="text-2-5">
<p>
9.将dev1的分支merge到dev2分支
在dev2分支下，git merge &#x2013;commit dev1
冲突的解决：
git merge产生冲突之后：
解决相应文件冲突，删除冲突标记，最后运行git add该文件表明冲突解决。或者使用git mergetool
</p>

<p>
产生冲突时,如果是文本文件则有冲突标记,如果是二进制文件,无法确定.
</p>

<p>
假设冲突文件是liba.so, 那么目录中仍然是liba.so(并且是当前dev2的liba.so),只是git status显示bothmodified.
</p>

<p>
使用 git checkout liba.so &#x2013;theirs 将会确认使用 dev1下的liba.so(此时md5值变成了dev1的), 然后 git add liba.so, git commit.
</p>

<p>
使用 git checkout liba.so &#x2013;ours 将会确认使用 dev2下的 liba.so(此时md5维持dev2的), 然后 git add lib.so, git commit.
</p>
</div>
</div>

<div id="outline-container-orgheadline13" class="outline-3">
<h3 id="orgheadline13"><span class="section-number-3">2.6</span> 标签操作 <code>git tag</code></h3>
<div class="outline-text-3" id="text-2-6">
<p>
标签管理，类似svn中的tags，用于对git中发布的重要发布点贴标签，便于以后跟踪。
*列出所有标签：
$git tag
</p>

<p>
*轻量级标签：
$git tag v1.4
这样为当前最新提交创建一个简单地标签。
</p>

<p>
*创建带注释的标签：
$git tag -a v1.4 -m "the version 1.4."
</p>

<p>
<b>搜索标签：
$ git tag -l v1.4.2.</b>
v1.4.2.1
v1.4.2.2
v1.4.2.3
v1.4.2.4
这样可以按照特定表达式搜索已有的标签。
</p>

<p>
*为以前的提交创建一个标签：
$git tag v1.1 2f5cff72102b47e7
这样会为2f5cff72102b47e7这个提交创建一个轻量级的标签。使用'git checkout'命令可以取出相应tag。
</p>

<p>
*查看标签：
$git show v1.1
这样会显示是一个标签，并且显示相应的commit信息。
</p>

<p>
*删除标签：
$git tag -d v1.1
这样会将v1.1的tag删除。
默认情况下，’git push’命令不会将标签上传到远程服务器上。为了共享这些标签，你必须在’git push’命令后明确添加-tags选项；git fetch会将远端tags下载。
</p>

<p>
*显示包含指定提交的tag：
git tag &#x2013;contains &lt;commit id&gt;
这里会显示所有包含commit id的tag，commit id可以省略，这时候显示包含head的tag。
**
</p>
</div>
</div>

<div id="outline-container-orgheadline14" class="outline-3">
<h3 id="orgheadline14"><span class="section-number-3">2.7</span> 配置操作 <code>git config</code></h3>
<div class="outline-text-3" id="text-2-7">
</div><div id="outline-container-orgheadline15" class="outline-4">
<h4 id="orgheadline15"><span class="section-number-4">2.7.1</span> 列出配置内容</h4>
<div class="outline-text-4" id="text-2-7-1">
<p>
查看所有配置内容
</p>
<div class="org-src-container">

<pre class="src src-sh">$git config -l
</pre>
</div>
<p>
涉及三个层级的配置文件： <code>system</code> 的, <code>global</code> 的， 以及 <code>local</code> 的。
</p>

<p>
<code>system</code> 的配置文件一般在 <code>/etc/gitconfig</code>,对所有用户有作用。
</p>

<p>
<code>global</code> 的配置文件一般在 <code>/home/.gitconfig</code>, 对当前用户有作用，会覆盖 <code>system</code> 的配置。
</p>

<p>
<code>local</code> 的配置文件一般在 <code>.git/config</code>, 对当前项目有作用，会覆盖 <code>global</code> 的配置。
</p>

<p>
如果只看某个层级的，只需要加上对应的 <code>--system</code>, <code>--global</code>, <code>--local</code> 选项即可。
</p>

<p>
比如查看 <code>global</code> 的配置选项
</p>
<div class="org-src-container">

<pre class="src src-sh">$git config --global -l
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline16" class="outline-4">
<h4 id="orgheadline16"><span class="section-number-4">2.7.2</span> 配置默认编辑器</h4>
<div class="outline-text-4" id="text-2-7-2">
<p>
配置当前项目默认编辑器为 <code>vim</code>
</p>
<div class="org-src-container">

<pre class="src src-sh">$git config core.editor vim
</pre>
</div>
<p>
相当于打开 <code>.git/config</code> 文件，在 <code>core</code> 中添加 <code>editor=vim</code>, 只对当前 <code>git</code> 项目有效。这样 <code>git commit</code> 之后会调出 <code>vim</code> 编辑信息。
</p>


<p>
如果配置成全局所有 <code>git</code> 项目默认都为 <code>vim</code> 如下：
</p>
<div class="org-src-container">

<pre class="src src-sh">$git config --global core.editor vim
</pre>
</div>
<p>
<code>--global</code> 表示会将配置应用到所有的 <code>git</code> 中，因为会保存到全局配置文件中, 而非针对当前项目的本地配置文件 <code>.git/config</code> 中了。
</p>

<p>
或者如果只是临时修改， 则设置 <code>EDITOR</code> 环境变量
</p>
<div class="org-src-container">

<pre class="src src-sh">$export EDITOR=vim
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-orgheadline17" class="outline-2">
<h2 id="orgheadline17"><span class="section-number-2">3</span> 远程同步与协作</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-orgheadline18" class="outline-3">
<h3 id="orgheadline18"><span class="section-number-3">3.1</span> 更新分支 <code>git rebase</code></h3>
<div class="outline-text-3" id="text-3-1">
<p>
下面从几个方面上来理解 <code>rebase</code> 命令
</p>
</div>
<div id="outline-container-orgheadline19" class="outline-4">
<h4 id="orgheadline19"><span class="section-number-4">3.1.1</span> 只有本地库</h4>
<div class="outline-text-4" id="text-3-1-1">
<p>
假设历史如下，并且当前的分之为 <code>topic</code>
</p>
<pre class="example">
      A---B---C topic
     /
D---E---F---G master
</pre>

<p>
对于这种情况，使用如下两个命令的任何一个，
</p>
<div class="org-src-container">

<pre class="src src-sh">$git rebase master
</pre>
</div>
<p>
或
</p>
<div class="org-src-container">

<pre class="src src-sh">$git rebase master topic
</pre>
</div>

<p>
这样，将会导致历史变成如下：
</p>
<pre class="example">
              A'--B'--C' topic
             /
D---E---F---G master
</pre>

<p>
注意，后面的命令 <code>$git rebase master topic</code> 实际就是 <code>git checkout topic</code> + <code>git rebase master</code> 这两条命令的简写。当 <code>rebase</code> 退出的时候，当前分支保持为 <code>topic</code> 分支。
</p>


<p>
2.如果上游分支已经包含了你已经做过的修改（例如：你通过电子邮件发送了一个修改的补丁并且这个补丁已经应用到了upstream上面），那么那个commit将会在rebase的时候被忽略。
例如在如下的历史中运行"git rebase master"（这里的A和A'虽然是不同的commiter信息,却表示同样的修改）：
</p>

<p>
      A&#x2014;B&#x2014;C topic
     /
D&#x2014;E&#x2014;A'&#x2014;F master
</p>

<p>
导致的结果将是：
</p>

<p>
               B'&#x2014;C' topic
              /
D&#x2014;E&#x2014;A'&#x2014;F master
</p>

<p>
3.如果你想要将一个基于某个分支的topic分支迁移到另外一个分支，使得我们看起来这个topic是基于那个另外的分支，那么，我们使用rebase &#x2013;onto。
首先，我们假设topic分支基于next分支。例如，topic分支中开发的某个功能依赖于next分支中的功能。如下：
</p>

<p>
o&#x2014;o&#x2014;o&#x2014;o&#x2014;o  master
     \
      o&#x2014;o&#x2014;o&#x2014;o&#x2014;o  next
                       \
                        o&#x2014;o&#x2014;o  topic
</p>

<p>
我们想要让topic基于master分支。例如:q
       We want to make topic forked from branch master; for example, because the functionality on which topic depends was
       merged into the more stable master branch. We want our tree to look like this:
</p>

<p>
o&#x2014;o&#x2014;o&#x2014;o&#x2014;o  master
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">\</td>
</tr>

<tr>
<td class="org-left">o'&#x2013;o'&#x2013;o'  topic</td>
</tr>
</tbody>
</table>
<p>
\
 o&#x2014;o&#x2014;o&#x2014;o&#x2014;o  next
</p>

<p>
We can get this using the following command:
</p>

<p>
git rebase &#x2013;onto master next topic
</p>
</div>
</div>
<div id="outline-container-orgheadline20" class="outline-4">
<h4 id="orgheadline20"><span class="section-number-4">3.1.2</span> pull</h4>
<div class="outline-text-4" id="text-3-1-2">
<p>
**rebase的作用
如果不进行rebase，那么使用git pull作用于已经有了提交的本地库，将会导致一个合并。rebase可以将本地修改置于pull之后，将历时简化，不会出现很多的分支。
1、对于git pull，
合并前：
          4&#x2013;&gt;6 (master)
         /     
1&#x2013;&gt;2&#x2013;&gt;3&#x2013;&gt;5 (origin/master)
相当于在远程3处调用了git clone，之后得到的本地库便具有两个分支（master表示本地主分支，origin/master表示git clone的来源分支）然后本地修改commit提交形成了本地版本4，同时远端origin/master继续前进至5，本地又也前进至6.
合并后：
          4&#x2013;&gt;6 
         /     \ 
1&#x2013;&gt;2&#x2013;&gt;3&#x2013;&gt;5&#x2013;&gt;7(master,origin/master)
相当于本地运行了一次git pull命令，于是导致远程分支的5和本地的6合并，生成新版本7。pull命令的作用是，获取远端修改，再将此修改合并到本地。
</p>

<p>
2、如果我们使用git pull &#x2013;rebase：
         4&#x2013;&gt;6 
         X     
 1&#x2013;&gt;2&#x2013;&gt;3&#x2013;&gt;5&#x2013;&gt;4`&#x2013;&gt;6`(master,origin/master)
相当于
a.缓存master自上次pull后本地所有的更改(即-&gt;4&#x2013;&gt;6的更改)，（实践发现，是第一次pull/clone相应分支的本地提交更改，哪怕之后没有&#x2013;rebase过很多次的pull）。
b.退回到上次pull的状态(即将master的-&gt;4&#x2013;&gt;6更改取消，退回到3)。
c.调用git pull获取并应用远端的修改（即将master前进到5）。
d.将之前缓存的本地修改应用到新的主分支上(即将之前缓存的-&gt;4&#x2013;&gt;6更改重新作用到5上，得到-&gt;4`&#x2013;&gt;6`，结果和合并一样，但是少了一个具有两个父亲节点的7，以及分支4-6，简化了前进日志过程)。
如果rebase过程中，出现冲突，那么可根据提示，运行"git mergetool"， 调用出相应的比较工具(如meld)进行冲突解决，最后git rebase &#x2013;continue继续进行rebase。
rebase之后，之前缓存的-&gt;4&#x2013;&gt;6的更改，已经无用了，可以用"git gc"将其清除。
</p>
</div>
</div>
<div id="outline-container-orgheadline21" class="outline-4">
<h4 id="orgheadline21"><span class="section-number-4">3.1.3</span> 有冲突时</h4>
<div class="outline-text-4" id="text-3-1-3">
<p>
rebase产生冲突后，大致提示如下：
Failed to merge in the changes.
Patch failed at 0001 [TPAPI] Secure buffer player.
</p>

<p>
When you have resolved this problem run "git rebase &#x2013;continue".
If you would prefer to skip this patch, instead run "git rebase &#x2013;skip".
To check out the original branch and stop rebasing run "git rebase &#x2013;abort".
通过git status可以知道哪些文件冲突了。
解决冲突后，运行git add将冲突文件添加进去（表示标记为解决冲突了），再进行git rebase &#x2013;continue
</p>

<p>
具体参考：
<a href="http://gitbook.liuhui998.com/4_2.html" target="_blank" rel="noopener">http://gitbook.liuhui998.com/4_2.html</a>
<a href="http://git-scm.com/book/zh/ch3-2.html" target="_blank" rel="noopener">http://git-scm.com/book/zh/ch3-2.html</a>
**
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-orgheadline22" class="outline-2">
<h2 id="orgheadline22"><span class="section-number-2">4</span> 获取当前库信息</h2>
</div>
<div id="outline-container-orgheadline23" class="outline-2">
<h2 id="orgheadline23"><span class="section-number-2">5</span> FAQ <code>[10%]</code><code>[2/20]</code></h2>
<div class="outline-text-2" id="text-5">
</div><div id="outline-container-orgheadline24" class="outline-3">
<h3 id="orgheadline24"><a id="ID-30eb6bfe-d849-402c-9213-6f061ca7d528"></a><span class="section-number-3">5.1</span> <span class="todo NEXT">NEXT</span> git describe</h3>
<div class="outline-text-3" id="text-5-1">
<ul class="org-ul">
<li>State "NEXT"       from              <span class="timestamp-wrapper"><span class="timestamp">[2016-01-08 五 10:03]</span></span></li>
</ul>
<p>
显示当前提交对应的tag，如果当前提交没有tag，则显示当前提交基于的tag，以及tag后发生了多少次提交，以及最近提交号简写。
</p>
<pre class="example">
假设有master和jike两个branches
$ git-branch
  jike
 *  master

# master分支基于tag:v2.6.27-rc5，head相对于该tag提交了361次
[arc@localhost  linux-2.6]$ git-describe
v2.6.27-rc5-361-g82a28c7

#jike分支基于tag:v2.6.27-rc5，head相对于该tag提交了320次，比master旧
[arc@localhost  linux-2.6]$ git-checkout jike
Switched  to branch "jike"
[arc@localhost  linux-2.6]$ git-describe
v2.6.27-rc5-320-gf8a561a
</pre>

<p>
参考：<a href="http://blog.csdn.net/yby19870627/article/details/7375121" target="_blank" rel="noopener">http://blog.csdn.net/yby19870627/article/details/7375121</a>
</p>
</div>
</div>

<div id="outline-container-orgheadline25" class="outline-3">
<h3 id="orgheadline25"><span class="section-number-3">5.2</span> <span class="todo NEXT">NEXT</span> git log</h3>
<div class="outline-text-3" id="text-5-2">
<ul class="org-ul">
<li>State "NEXT"       from              <span class="timestamp-wrapper"><span class="timestamp">[2016-01-08 五 10:37]</span></span></li>
</ul>
</div>

<div id="outline-container-orgheadline26" class="outline-4">
<h4 id="orgheadline26"><span class="section-number-4">5.2.1</span> &#x2013;decorate</h4>
<div class="outline-text-4" id="text-5-2-1">
<p>
git log命令的&#x2013;decorate参数可以在提交ID的旁边显示该提交关联的引用（里程碑或分支）
</p>
<div class="org-src-container">

<pre class="src src-sh">commit 1ff5d5435ef8a4bafe51ea10cc4be8be63903c2a (HEAD, tag: QM153E_R0.5.99.0, tag: QM153E_R0.5.98.0, tag: QM152E_R0.5.98.1, tag: QM152E_R0.5.98.0, tag
Author: van.huang &lt;van.huang@tpv-tech.com&gt;
Date:   Sat Oct 10 10:30:31 2015 +0800

    [TPAPI]Fix 2K16 U+ DVB-S TS issue.
    URTRACKER:PPR2-EU

    ::::        ::::
    Cherry Pick from 9df216d714a7ef3358b604753f223de47647a56b
    ::::                        :::

    Change-Id: Ieb360ec0ee10ecd54138b0db95d7f9c32bd34956

commit e59a4968b80b9335200053013eb6a9c774e10ef7
Author: paul.deng &lt;paul.deng@tpv-tech.com&gt;
Date:   Sat Oct 10 10:30:31 2015 +0800

    [TPAPI][DEMUX] Enable CRC Error Threshold Exceeded notification.
    URTRACKER:PPR2

    ::::        ::::
...
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline27" class="outline-4">
<h4 id="orgheadline27"><span class="section-number-4">5.2.2</span> 查看某两个tag/commit之间的log</h4>
<div class="outline-text-4" id="text-5-2-2">
<div class="org-src-container">

<pre class="src src-sh">$git log tag1 tag2
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline28" class="outline-4">
<h4 id="orgheadline28"><span class="section-number-4">5.2.3</span> 格式化的输出</h4>
<div class="outline-text-4" id="text-5-2-3">
<p>
Commit Date在 <code>2018-06-14</code> 以来的，作者为"miracle.lv"的，"origin/2k18_mtk_msaf_kane_n_devprod_ctv"分支上的提交信息，仅包含作者，日期，以及宽度在32以内的注释。
</p>
<div class="org-src-container">

<pre class="src src-sh">$git rev-list --reverse --pretty=format:"Author: %an%nCommit date: %ci%nDescription: %&lt;(32,trunc)%s" --since=2018-06-14 --author="miracle.lv" origin/2k18_mtk_msaf_kane_n_devprod_ctv |head -n4
commit 481a592b6afb07aff347b5948acfdb444981022c
Author: Miracle Lv
Commit date: 2018-06-26 17:14:42 +0800
Description: Improve check for branch for i..
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline29" class="outline-4">
<h4 id="orgheadline29"><span class="section-number-4">5.2.4</span> 查看日志同时也显示具体修改的文件</h4>
<div class="outline-text-4" id="text-5-2-4">
<div class="org-src-container">

<pre class="src src-sh">$git log -p
</pre>
</div>
<p>
除了显示commit id等基本信息外，还显示具体修改了文件的什么内容，结果用git diff的方式显示出来。
</p>

<div class="org-src-container">

<pre class="src src-sh">$git log --stat
</pre>
</div>
<p>
显示commit id之外，显示修改了哪些文件以及多少行，但是不具体显示修改内容。
</p>
</div>
</div>
<div id="outline-container-orgheadline30" class="outline-4">
<h4 id="orgheadline30"><span class="section-number-4">5.2.5</span> 待阅</h4>
<div class="outline-text-4" id="text-5-2-5">
<p>
<a href="https://blog.csdn.net/u011240877/article/details/52586664" target="_blank" rel="noopener">git 对比两个分支差异</a>
</p>

<pre class="example">
查看 dev 有，而 master 中没有的：
git log dev ^master 

同理查看 master 中有，而 dev 中没有的内容：
git log master ^dev

查看 dev 中比 master 中多提交了哪些内容：
git log master..dev
注意，列出来的是两个点后边（此处即dev）多提交的内容。

不知道谁提交的多谁提交的少，单纯想知道有什么不一样：
git log dev...master

在上述情况下，再显示出每个提交是在哪个分支上：
git log --left-right dev...master
注意 commit 后面的箭头，根据我们在 –left-right dev…master 的顺序，左箭头 &lt; 表示是 dev 的，右箭头 &gt; 表示是 master的。
</pre>
</div>
</div>
</div>
<div id="outline-container-orgheadline31" class="outline-3">
<h3 id="orgheadline31"><span class="section-number-3">5.3</span> <span class="todo NEXT">NEXT</span> git revert</h3>
<div class="outline-text-3" id="text-5-3">
<ul class="org-ul">
<li>State "NEXT"       from              <span class="timestamp-wrapper"><span class="timestamp">[2017-06-30 五 11:19]</span></span></li>
</ul>

<p>
与 概念上的revert还是不一样的，因为在多分支合并的时候revert还是有问题的，考虑用merge来模拟回退。
参考：<a href="http://blog.csdn.net/secretx/article/details/51461972" target="_blank" rel="noopener">http://blog.csdn.net/secretx/article/details/51461972</a>
</p>


<p>
<code>git revert &lt;commit id&gt;</code> 撤销仅 <code>&lt;commit id&gt;</code> 对应的提交。不包含 <code>&lt;commit id&gt;</code> 到当前 HEAD的其他提交的撤销。
</p>
</div>
</div>
<div id="outline-container-orgheadline32" class="outline-3">
<h3 id="orgheadline32"><span class="section-number-3">5.4</span> <span class="todo NEXT">NEXT</span> git remote</h3>
<div class="outline-text-3" id="text-5-4">
<ul class="org-ul">
<li>State "NEXT"       from              <span class="timestamp-wrapper"><span class="timestamp">[2016-01-09 六 11:19]</span></span></li>
</ul>

<p>
如下：
</p>
<pre class="example">
 1 [core]
 2     repositoryformatversion = 0
 3     filemode = true
 4     bare = false
 5     logallrefupdates = true
 6     worktree = /home2/miracle.lv/wk16.1_2k16ppr1gits/device/tpvision/tvsoc/tvsoc_mtk
 7 [remote "origin"]
 8     fetch = +refs/heads/*:refs/remotes/origin/*
 9     url = /home2/miracle.lv/wk16.1_2k16ppr1gits/../2k16ppr1gits//.gits/projects/device/tpvision/tvsoc/tvsoc_mtk
10 [branch "default_head"]
11     remote = origin
12     merge = refs/heads/default_head
</pre>

<p>
运行
<code>git remote add mirror ssh://gerrit/device/tpvision/tvsoc/tvsoc_mtk</code>
如下
</p>
<pre class="example">
 1 [core]
 2     repositoryformatversion = 0
 3     filemode = true
 4     bare = false
 5     logallrefupdates = true
 6     worktree = /home2/miracle.lv/wk16.1_2k16ppr1gits/device/tpvision/tvsoc/tvsoc_mtk
 7 [remote "origin"]
 8     fetch = +refs/heads/*:refs/remotes/origin/*
 9     url = /home2/miracle.lv/wk16.1_2k16ppr1gits/../2k16ppr1gits//.gits/projects/device/tpvision/tvsoc/tvsoc_mtk
10 [branch "default_head"]
11     remote = origin
12     merge = refs/heads/default_head
13 [remote "mirror"]
14     url = ssh://gerrit/device/tpvision/tvsoc/tvsoc_mtk
15     fetch = +refs/heads/*:refs/remotes/mirror/*
</pre>
</div>
</div>
<div id="outline-container-orgheadline33" class="outline-3">
<h3 id="orgheadline33"><span class="section-number-3">5.5</span> <span class="todo LATER">LATER</span> git grep等搜索方式</h3>
<div class="outline-text-3" id="text-5-5">
<ul class="org-ul">
<li>State "LATER"      from "INBOX"      <span class="timestamp-wrapper"><span class="timestamp">[2016-01-16 六 09:40]</span></span></li>
</ul>
<p>
Capture Time:<span class="timestamp-wrapper"><span class="timestamp">[2016-01-11 一 10:42]</span></span>
</p>
<hr>
</div>
</div>
<div id="outline-container-orgheadline34" class="outline-3">
<h3 id="orgheadline34"><a id="ID-6a8a38a4-b956-40bf-b427-a2cac6f3d282"></a><span class="section-number-3">5.6</span> <span class="todo LATER">LATER</span> git对链接文件的管理</h3>
<div class="outline-text-3" id="text-5-6">
<ul class="org-ul">
<li>State "LATER"      from "INBOX"      <span class="timestamp-wrapper"><span class="timestamp">[2016-01-16 六 09:40]</span></span></li>
</ul>
<p>
Capture Time:<span class="timestamp-wrapper"><span class="timestamp">[2016-01-11 一 11:18]</span></span>
</p>
<hr>
</div>
</div>
<div id="outline-container-orgheadline35" class="outline-3">
<h3 id="orgheadline35"><span class="section-number-3">5.7</span> <span class="todo WAIT_FORWARD">WAIT/FORWARD</span> git commit</h3>
<div class="outline-text-3" id="text-5-7">
<ul class="org-ul">
<li>State "WAIT/FORWARD" from "INBOX"      <span class="timestamp-wrapper"><span class="timestamp">[2016-08-24 三 11:10] </span></span> <br>
wait for more.</li>
</ul>
<p>
Capture Time:<span class="timestamp-wrapper"><span class="timestamp">[2016-03-04 五 16:52]</span></span>
</p>
<hr>

<p>
如果提交之后，想要修改提交日志，可以用 <code>git commit --amend</code> 这样会将提交日志修改，同时提交号会自动相应修改。
</p>
</div>
</div>
<div id="outline-container-orgheadline36" class="outline-3">
<h3 id="orgheadline36"><span class="section-number-3">5.8</span> <span class="todo WAIT_FORWARD">WAIT/FORWARD</span> git如何管理软链接？</h3>
<div class="outline-text-3" id="text-5-8">
<ul class="org-ul">
<li>State "WAIT/FORWARD" from "INBOX"      <span class="timestamp-wrapper"><span class="timestamp">[2016-08-24 三 11:01] </span></span> <br>
已经实践确认，需要进一步整理。</li>
</ul>
<p>
Capture Time:<span class="timestamp-wrapper"><span class="timestamp">[2016-07-28 四 15:56]</span></span>
</p>
<hr>
<p>
实践的结果：
</p>
</div>
<div id="outline-container-orgheadline37" class="outline-4">
<h4 id="orgheadline37"><span class="section-number-4">5.8.1</span> 软链接</h4>
<div class="outline-text-4" id="text-5-8-1">
<p>
结论：软链接会在clone中仍然以软链接的方式管理，并且clone中软链接的值和orig中一样，即便不存在。
</p>

<p>
origin中创建一个相对路径的和绝对路径的软链接，clone之后，相应的文件也是软链接，软链接所指向的路径和origin中的一样。而非根据clone进行相应调整。
</p>
<div class="org-src-container">

<pre class="src src-sh">miracle@miracle-Zhaoyang-E49:~/test/git/orig_repos$ cd 10
miracle@miracle-Zhaoyang-E49:~/test/git/orig_repos/10$ ls
1
miracle@miracle-Zhaoyang-E49:~/test/git/orig_repos/10$ pwd
/home/miracle/test/git/orig_repos/10
miracle@miracle-Zhaoyang-E49:~/test/git/orig_repos/10$ ln -s /home/miracle/test/git/orig_repos/2 .
miracle@miracle-Zhaoyang-E49:~/test/git/orig_repos/10$ ls -l
总用量 0
lrwxrwxrwx 1 miracle video  4  7月 28 16:09 1 -&gt; ../1   
lrwxrwxrwx 1 miracle video 35  7月 28 16:11 2 -&gt; /home/miracle/test/git/orig_repos/2

miracle@miracle-Zhaoyang-E49:~/test/git/orig_repos/10$ cd ..
miracle@miracle-Zhaoyang-E49:~/test/git/orig_repos$ git add .
miracle@miracle-Zhaoyang-E49:~/test/git/orig_repos$ git commit -m 'add absolute softlink'
miracle@miracle-Zhaoyang-E49:~/test/git/clone_repos$ git pull
miracle@miracle-Zhaoyang-E49:~/test/git/clone_repos/10$ ls -l
总用量 0
lrwxrwxrwx 1 miracle video  4  7月 28 16:09 1 -&gt; ../1   
lrwxrwxrwx 1 miracle video 35  7月 28 16:11 2 -&gt; /home/miracle/test/git/orig_repos/2
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline38" class="outline-4">
<h4 id="orgheadline38"><span class="section-number-4">5.8.2</span> 硬链接</h4>
<div class="outline-text-4" id="text-5-8-2">
<p>
结论：硬链接，会做为独立文件在clone中保存，占用额外空间。
</p>

<p>
origin中创建一个大文件的硬链接，提交上去之后，发现origin的总空间只有一份大文件。
</p>
<div class="org-src-container">

<pre class="src src-sh">miracle@miracle-Zhaoyang-E49:~/test/git/orig_repos$ du -shc *
4.0K    1
4.0K    10
4.0K    2
4.0K    3
4.0K    4
4.0K    5
4.0K    6
4.0K    7
8.0K    8
8.0K    9
292K    lxr-2.0.3.tgz
340K    总用量
miracle@miracle-Zhaoyang-E49:~/test/git/orig_repos$ cd 10
miracle@miracle-Zhaoyang-E49:~/test/git/orig_repos/10$ ls
1  2
miracle@miracle-Zhaoyang-E49:~/test/git/orig_repos/10$ ln ../lxr-2.0.3.tgz
miracle@miracle-Zhaoyang-E49:~/test/git/orig_repos/10$ ls
1  2  lxr-2.0.3.tgz
miracle@miracle-Zhaoyang-E49:~/test/git/orig_repos/10$ ls -l
总用量 292
lrwxrwxrwx 1 miracle video      4  7月 28 16:08 1 -&gt; ../1
lrwxrwxrwx 1 miracle video     35  7月 28 16:10 2 -&gt; /home/miracle/test/git/orig_repos/2
-rw-rw-r-- 2 miracle video 296434  7月 22  2015 lxr-2.0.3.tgz
miracle@miracle-Zhaoyang-E49:~/test/git/orig_repos/10$ cd ..
miracle@miracle-Zhaoyang-E49:~/test/git/orig_repos$ du -shc *
4.0K    1
296K    10
4.0K    2
4.0K    3
4.0K    4
4.0K    5
4.0K    6
4.0K    7
8.0K    8
8.0K    9
340K    总用量
miracle@miracle-Zhaoyang-E49:~/test/git/orig_repos$ git add .
miracle@miracle-Zhaoyang-E49:~/test/git/orig_repos$ git commit -m 'add hardlink'
[master 36db099] add hardlink
 1 file changed, 0 insertions(+), 0 deletions(-)
 create mode 100644 10/lxr-2.0.3.tgz
miracle@miracle-Zhaoyang-E49:~/test/git/orig_repos$ du -shc *
4.0K    1
296K    10
4.0K    2
4.0K    3
4.0K    4
4.0K    5
4.0K    6
4.0K    7
8.0K    8
8.0K    9
340K    总用量
</pre>
</div>

<p>
clone进行pull之后，硬链接的相应路径处，是单独拷贝的一个文件，clone的空间反而有两份大文件。
</p>
<div class="org-src-container">

<pre class="src src-sh">miracle@miracle-Zhaoyang-E49:~/test/git$ cd clone_repos/
miracle@miracle-Zhaoyang-E49:~/test/git/clone_repos$ ls 
1  10  2  3  4  5  6  7  8  9  lxr-2.0.3.tgz
miracle@miracle-Zhaoyang-E49:~/test/git/clone_repos$ git pull
remote: Counting objects: 5, done.
remote: Compressing objects: 100% (3/3), done.
remote: Total 3 (delta 1), reused 0 (delta 0)
Unpacking objects: 100% (3/3), done.
From /home/miracle/test/git/orig_repos
   1037bba..36db099  master     -&gt; origin/master
Updating 1037bba..36db099
Fast-forward
 10/lxr-2.0.3.tgz |  Bin 0 -&gt; 296434 bytes
 1 file changed, 0 insertions(+), 0 deletions(-)
 create mode 100644 10/lxr-2.0.3.tgz
miracle@miracle-Zhaoyang-E49:~/test/git/clone_repos$ git status .
# On branch master
nothing to commit (working directory clean)
miracle@miracle-Zhaoyang-E49:~/test/git/clone_repos$ du -shc *
4.0K    1
296K    10
4.0K    2
4.0K    3
4.0K    4
4.0K    5
4.0K    6
4.0K    7
8.0K    8
8.0K    9
292K    lxr-2.0.3.tgz
632K    总用量
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgheadline39" class="outline-3">
<h3 id="orgheadline39"><span class="section-number-3">5.9</span> <span class="todo LATER">LATER</span> git submodule研究</h3>
<div class="outline-text-3" id="text-5-9">
<ul class="org-ul">
<li>State "LATER"      from "NEXT"       <span class="timestamp-wrapper"><span class="timestamp">[2016-08-24 三 11:10]</span></span></li>
<li>State "NEXT"       from              <span class="timestamp-wrapper"><span class="timestamp">[2016-08-24 三 11:10]</span></span></li>
</ul>
</div>
</div>
<div id="outline-container-orgheadline40" class="outline-3">
<h3 id="orgheadline40"><span class="section-number-3">5.10</span> <span class="todo LATER">LATER</span> git的push和pull如何实现免密码？</h3>
<div class="outline-text-3" id="text-5-10">
<ul class="org-ul">
<li>State "LATER"      from "WAIT/FORWARD" <span class="timestamp-wrapper"><span class="timestamp">[2016-12-15 四 17:24]</span></span></li>
<li>State "WAIT/FORWARD" from "WAIT/FORWARD" <span class="timestamp-wrapper"><span class="timestamp">[2016-12-15 四 17:24] </span></span> <br>
wait for move</li>
<li>State "WAIT/FORWARD" from "INBOX"      <span class="timestamp-wrapper"><span class="timestamp">[2016-12-15 四 17:24]</span></span></li>
</ul>
<p>
Capture Time:<span class="timestamp-wrapper"><span class="timestamp">[2016-09-05 一 10:57]</span></span>
</p>
<hr>
</div>
</div>

<div id="outline-container-orgheadline41" class="outline-3">
<h3 id="orgheadline41"><span class="section-number-3">5.11</span> <span class="todo LATER">LATER</span> git push技巧</h3>
<div class="outline-text-3" id="text-5-11">
<ul class="org-ul">
<li>State "LATER"      from "INBOX"      <span class="timestamp-wrapper"><span class="timestamp">[2017-04-07 五 16:17]</span></span></li>
</ul>
<p>
Capture Time:<span class="timestamp-wrapper"><span class="timestamp">[2017-02-21 二 11:10]</span></span>
</p>

<ol class="org-ol">
<li>首先将本地修改提交到本地( <code>git add &amp;&amp; git commit &amp;&amp; git pull --rebase</code>)</li>
<li>本地编译</li>
<li>不用管编译的中间文件，如果编译通过，直接用 <code>git push xxx HEAD:refs/for/xxx</code> 提交。</li>
</ol>
</div>
</div>

<div id="outline-container-orgheadline42" class="outline-3">
<h3 id="orgheadline42"><span class="section-number-3">5.12</span> <span class="todo WAIT_FORWARD">WAIT/FORWARD</span> <code>.gitignore</code> 中列出的文件在 <code>git add</code> 之后，就不管用了。</h3>
<div class="outline-text-3" id="text-5-12">
<ul class="org-ul">
<li>State "WAIT/FORWARD" from "LATER"      <span class="timestamp-wrapper"><span class="timestamp">[2017-04-07 五 16:27] </span></span> <br>
wait for arranged.</li>
<li>State "LATER"      from "INBOX"      <span class="timestamp-wrapper"><span class="timestamp">[2017-04-07 五 16:27]</span></span></li>
</ul>
<p>
Capture Time:<span class="timestamp-wrapper"><span class="timestamp">[2017-03-31 五 21:07]</span></span>
</p>
</div>
</div>

<div id="outline-container-orgheadline43" class="outline-3">
<h3 id="orgheadline43"><span class="section-number-3">5.13</span> <span class="todo WAIT_FORWARD">WAIT/FORWARD</span> git dir</h3>
<div class="outline-text-3" id="text-5-13">
<ul class="org-ul">
<li>State "WAIT/FORWARD" from "LATER"      <span class="timestamp-wrapper"><span class="timestamp">[2017-04-07 五 16:30] </span></span> <br>
wait for arranged.</li>
<li>State "LATER"      from "INBOX"      <span class="timestamp-wrapper"><span class="timestamp">[2017-04-07 五 16:30]</span></span></li>
</ul>
<p>
Capture Time:<span class="timestamp-wrapper"><span class="timestamp">[2017-04-06 四 17:33]</span></span>
</p>

<p>
如果想要将 '.git/' 目录放到另外一个地方，在工作目录中创建 '.git' 文件指向实际的 '.git/' 目录，如下：
</p>
<div class="org-src-container">

<pre class="src src-sh">$vim .git
 gitdir: /home/miracle/mydata/cloud/MEGAsync/mydata/study/mygitrepo/vaqeteart.github.io.git
</pre>
</div>
</div>
</div>
<div id="outline-container-orgheadline44" class="outline-3">
<h3 id="orgheadline44"><span class="section-number-3">5.14</span> <span class="todo LATER">LATER</span> 理解git原理的关键</h3>
<div class="outline-text-3" id="text-5-14">
<ul class="org-ul">
<li>State "LATER"      from              <span class="timestamp-wrapper"><span class="timestamp">[2017-04-08 六 10:50]</span></span></li>
</ul>
</div>
<div id="outline-container-orgheadline45" class="outline-4">
<h4 id="orgheadline45"><span class="section-number-4">5.14.1</span> 分布式的理解</h4>
<div class="outline-text-4" id="text-5-14-1">
<p>
基于 <code>git</code> 的分布式版本控制，每个端都是独立的服务器，通过 <code>git pull</code> / <code>git push</code> 相互同步。
</p>
</div>
</div>
<div id="outline-container-orgheadline46" class="outline-4">
<h4 id="orgheadline46"><span class="section-number-4">5.14.2</span> 工作流程、状态</h4>
<div class="outline-text-4" id="text-5-14-2">
<p>
主要指 <code>svn &amp; git</code> 的 <code>add,commit,status</code>, 各有何不同？
</p>
</div>
</div>

<div id="outline-container-orgheadline47" class="outline-4">
<h4 id="orgheadline47"><span class="section-number-4">5.14.3</span> 工作空间(work area)、缓存空间(staged area)、库(repository)</h4>
<div class="outline-text-4" id="text-5-14-3">
<p>
最好能有相应配图。
</p>
</div>
</div>
<div id="outline-container-orgheadline48" class="outline-4">
<h4 id="orgheadline48"><span class="section-number-4">5.14.4</span> 针对 <code>git</code> 的内容</h4>
<div class="outline-text-4" id="text-5-14-4">
<p>
<code>object</code>, <code>snapshot</code>, <code>index</code>, <code>repository</code>.
</p>

<p>
<code>git directory</code>, <code>git work directory</code>, <code>fast-forward</code>.
</p>
</div>
</div>
</div>
<div id="outline-container-orgheadline49" class="outline-3">
<h3 id="orgheadline49"><span class="section-number-3">5.15</span> <span class="todo NEXT">NEXT</span> git checkout 到一个 <code>git log</code> 中非HEAD的版本后，如何checkout回来？</h3>
<div class="outline-text-3" id="text-5-15">
<ul class="org-ul">
<li>State "NEXT"       from              <span class="timestamp-wrapper"><span class="timestamp">[2017-04-12 三 13:51]</span></span></li>
</ul>
</div>
</div>
<div id="outline-container-orgheadline50" class="outline-3">
<h3 id="orgheadline50"><span class="section-number-3">5.16</span> <span class="todo NEXT">NEXT</span> git reflog</h3>
<div class="outline-text-3" id="text-5-16">
<ul class="org-ul">
<li>State "NEXT"       from              <span class="timestamp-wrapper"><span class="timestamp">[2017-04-12 三 13:51]</span></span></li>
</ul>
</div>
</div>
<div id="outline-container-orgheadline51" class="outline-3">
<h3 id="orgheadline51"><span class="section-number-3">5.17</span> <span class="todo NEXT">NEXT</span> git mergebase ref1 ref2</h3>
<div class="outline-text-3" id="text-5-17">
<ul class="org-ul">
<li>State "NEXT"       from              <span class="timestamp-wrapper"><span class="timestamp">[2017-04-12 三 14:17]</span></span></li>
</ul>
</div>
</div>
<div id="outline-container-orgheadline52" class="outline-3">
<h3 id="orgheadline52"><span class="section-number-3">5.18</span> <span class="todo NEXT">NEXT</span> git shortlog</h3>
<div class="outline-text-3" id="text-5-18">
<ul class="org-ul">
<li>State "NEXT"       from              <span class="timestamp-wrapper"><span class="timestamp">[2017-04-13 四 10:12]</span></span></li>
</ul>
<p>
按照用户名来归类信息。
</p>
</div>
</div>
<div id="outline-container-orgheadline53" class="outline-3">
<h3 id="orgheadline53"><span class="section-number-3">5.19</span> 分支合并的一个例子</h3>
<div class="outline-text-3" id="text-5-19">
<p>
目前在一个FVP分支下进行工作主要修改的目录是 <code>apollo/third_party</code>, 但是主分支上的修改需要有如下两种方式同步:
</p>
<ol class="org-ol">
<li>要么定期合并到FVP</li>
<li>要么基于最新主分支新开一个FVP分支, 然后把之前的FVP分支工作合并到新FVP.</li>
</ol>

<p>
目前采用第2中方案.所以每次集成之前,需要先将旧的FVP分支迁移到新的FVP分支上. 过程用实例说明,大致过程如下
</p>
</div>
<div id="outline-container-orgheadline54" class="outline-4">
<h4 id="orgheadline54"><span class="section-number-4">5.19.1</span> 先切换到新的分支上</h4>
<div class="outline-text-4" id="text-5-19-1">
<div class="org-src-container">

<pre class="src src-sh">$repo init -u ssh://url/tpv/platform/manifest -b 2k17_mtk_archer_m_devprod_FVP_R2_21
$repo sync
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline55" class="outline-4">
<h4 id="orgheadline55"><span class="section-number-4">5.19.2</span> 确认修改工作所在路径的新旧分支公共的 <code>commit ID</code></h4>
<div class="outline-text-4" id="text-5-19-2">
<div class="org-src-container">

<pre class="src src-sh">miracle.lv@cnszs215:~/masf/apollo/third_party$ pwd
/home/miracle.lv/masf/apollo/third_party

miracle.lv@cnszs215:~/masf/apollo/third_party$ git merge-base origin/2k17_mtk_archer_m_devprod_FVP origin/2k17_mtk_archer_m_devprod_FVP_R2_21 |git show
commit 85d9f860bd0c82dfceca081ab9da0fb8a7bbf007
Author: patrick.lee &lt;Patrick.Lee@tpv-tech.com&gt;
Date:   Wed Mar 15 17:39:44 2017 +0800
.....
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline56" class="outline-4">
<h4 id="orgheadline56"><span class="section-number-4">5.19.3</span> 修改工作目录切换到新FVP分支,并</h4>
<div class="outline-text-4" id="text-5-19-3">
<div class="org-src-container">

<pre class="src src-sh">miracle.lv@cnszs215:~/masf/apollo/third_party$git branch -a |grep FVP
miracle.lv@cnszs215:~/masf/apollo/third_party$git checkout -b 2k17_mtk_archer_m_devprod_FVP_R2_21 origin/2k17_mtk_archer_m_devprod_FVP_R2_21
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline57" class="outline-4">
<h4 id="orgheadline57"><span class="section-number-4">5.19.4</span> 记录新分支的HEAD</h4>
<div class="outline-text-4" id="text-5-19-4">
<div class="org-src-container">

<pre class="src src-sh">miracle.lv@cnszs215:~/masf/apollo/third_party$git log
commit 85d9f860bd0c82dfceca081ab9da0fb8a7bbf007
Author: patrick.lee &lt;Patrick.Lee@tpv-tech.com&gt;
Date:   Wed Mar 15 17:39:44 2017 +0800

    Merger_t-apollo-mp-1501-1550-5-001-15-001-206-001-243

    Change-Id: I5d8d4af735664f183a2782c7680ad342eb90da97
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline58" class="outline-4">
<h4 id="orgheadline58"><span class="section-number-4">5.19.5</span> 将旧分支工作合并到新分支</h4>
<div class="outline-text-4" id="text-5-19-5">
</div><div id="outline-container-orgheadline75" class="outline-5">
<h5 id="orgheadline75"><span class="section-number-5">5.19.5.1</span> 尝试直接合并</h5>
<div class="outline-text-5" id="text-5-19-5-1">
<div class="org-src-container">

<pre class="src src-sh">$git merge --commit origin/2k17_mtk_archer_m_devprod_FVP 2&gt;&amp;1 |tee conflict
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline76" class="outline-5">
<h5 id="orgheadline76"><span class="section-number-5">5.19.5.2</span> 用 <code>cat conflict</code> 查看冲突信息提示</h5>
<div class="outline-text-5" id="text-5-19-5-2">
<pre class="example">
warning: Cannot merge binary files: source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/player/libspotify_player.so (HEAD vs. origin/2k17_mtk_archer_m_devprod_FVP)
warning: Cannot merge binary files: source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/jsplugin/build_out/src/main.o (HEAD vs. origin/2k17_mtk_archer_m_devprod_FVP)
warning: Cannot merge binary files: source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/jsplugin/build_out/src/SpotifyMtk.o (HEAD vs. origin/2k17_mtk_archer_m_devprod_FVP)
warning: Cannot merge binary files: source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/jsplugin/build_out/src/Player.o (HEAD vs. origin/2k17_mtk_archer_m_devprod_FVP)
warning: Cannot merge binary files: source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/jsplugin/build_out/src/BridgeCallbacks.o (HEAD vs. origin/2k17_mtk_archer_m_devprod_FVP)
warning: Cannot merge binary files: source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/jsplugin/build_out/spotifyjsplugin.so (HEAD vs. origin/2k17_mtk_archer_m_devprod_FVP)
warning: Cannot merge binary files: source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/jsplugin/build_out/include/jspp/main.o (HEAD vs. origin/2k17_mtk_archer_m_devprod_FVP)
Auto-merging source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/player/libspotify_player.so
CONFLICT (content): Merge conflict in source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/player/libspotify_player.so
Auto-merging source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/jsplugin/build_out/src/main.o
CONFLICT (content): Merge conflict in source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/jsplugin/build_out/src/main.o
Auto-merging source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/jsplugin/build_out/src/SpotifyMtk.o
CONFLICT (content): Merge conflict in source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/jsplugin/build_out/src/SpotifyMtk.o
Auto-merging source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/jsplugin/build_out/src/Player.o
CONFLICT (content): Merge conflict in source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/jsplugin/build_out/src/Player.o
Auto-merging source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/jsplugin/build_out/src/BridgeCallbacks.o
CONFLICT (content): Merge conflict in source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/jsplugin/build_out/src/BridgeCallbacks.o
Auto-merging source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/jsplugin/build_out/spotifyjsplugin.so
CONFLICT (content): Merge conflict in source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/jsplugin/build_out/spotifyjsplugin.so
Auto-merging source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/jsplugin/build_out/include/jspp/main.o
CONFLICT (content): Merge conflict in source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/jsplugin/build_out/include/jspp/main.o
Removing source/browser_engine/v2.0/source/browserstub/opera/sdk40/operasdk/include/opera/events/CanStartHbbTVApplication.h
Auto-merging source/browser_engine/v2.0/source/browserstub/opera/sdk40/backend/include/uva_memory_deprecated.h
Removing source/browser_engine/v2.0/source/browserstub/opera/sdk40/backend/Uvawidevine/wv_api.h
Removing source/browser_engine/v2.0/source/browserstub/opera/sdk40/backend/Uvawidevine/wv_api.cpp
Removing source/browser_engine/v2.0/source/browserstub/opera/sdk40/backend/Uvawidevine/managed_drm_backend.h
Removing source/browser_engine/v2.0/source/browserstub/opera/sdk40/backend/Uvawidevine/managed_drm_backend.cpp
Removing source/browser_engine/v2.0/source/browserstub/opera/sdk40/backend/Uvawidevine/include/wvadapter.h
Automatic merge failed; fix conflicts and then commit the result.
</pre>
</div>
</div>

<div id="outline-container-orgheadline77" class="outline-5">
<h5 id="orgheadline77"><span class="section-number-5">5.19.5.3</span> 用 <code>git status</code> 查看冲突</h5>
<div class="outline-text-5" id="text-5-19-5-3">
<div class="org-src-container">

<pre class="src src-sh">$git status
...
Unmerged paths:
  (use "git add &lt;file&gt;..." to mark resolution)

        both modified:      source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/jsplugin/build_out/include/jspp/main.o
        both modified:      source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/jsplugin/build_out/spotifyjsplugin.so
        both modified:      source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/jsplugin/build_out/src/BridgeCallbacks.o
        both modified:      source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/jsplugin/build_out/src/Player.o
        both modified:      source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/jsplugin/build_out/src/SpotifyMtk.o
        both modified:      source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/jsplugin/build_out/src/main.o
        both modified:      source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/player/libspotify_player.so
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline78" class="outline-5">
<h5 id="orgheadline78"><span class="section-number-5">5.19.5.4</span> 解决冲突的一个方式</h5>
<div class="outline-text-5" id="text-5-19-5-4">
<p>
具体视情况而定,这里冲突文件以二进制冲突做为例子,并且解决方案是只采用旧分支的二进制文件.
</p>
<div class="org-src-container">

<pre class="src src-sh">$git checkout source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/jsplugin/build_out/include/jspp/main.o --theirs
$git add source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/jsplugin/build_out/include/jspp/main.o
$git checkout source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/jsplugin/build_out/spotifyjsplugin.so --theirs
$git source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/jsplugin/build_out/spotifyjsplugin.so
$git checkout source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/jsplugin/build_out/src/BridgeCallbacks.o --theirs
$git add source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/jsplugin/build_out/src/BridgeCallbacks.o
$git checkout source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/jsplugin/build_out/src/Player.o --theirs
$git add source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/jsplugin/build_out/src/Player.o
$git checkout source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/jsplugin/build_out/src/SpotifyMtk.o --theirs
$git add source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/jsplugin/build_out/src/SpotifyMtk.o
$git checkout source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/jsplugin/build_out/src/main.o --theirs
$git add source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/jsplugin/build_out/src/main.o
$git checkout source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/player/libspotify_player.so --theirs
$git add source/browser_engine/v2.0/source/browserstub/opera/sdk40/plugins/spotifyjsplugin/player/libspotify_player.so
</pre>
</div>
</div>
</div>



<div id="outline-container-orgheadline79" class="outline-5">
<h5 id="orgheadline79"><span class="section-number-5">5.19.5.5</span> 编辑器</h5>
<div class="outline-text-5" id="text-5-19-5-5">
<div class="org-src-container">

<pre class="src src-sh">$git config --global core.editor vim
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-orgheadline59" class="outline-3">
<h3 id="orgheadline59"><span class="section-number-3">5.20</span> 回退与合并指定区间的例子</h3>
<div class="outline-text-3" id="text-5-20">
<p>
目标：主分支(master)在A处，建立了分支(b1), 经过一段时间主分支到达B，b1变成(b1*)，这时候建立分支(b2)，目的是丢弃主分支A-&gt;B的修改，直接将b2变成b1*。
</p>

<pre class="example">
b1            ---------b1*---
             /
Master -----*(A)------*(B)-----
                       \
b2                      -----
</pre>

<p>
过程如下
</p>
</div>

<div id="outline-container-orgheadline60" class="outline-4">
<h4 id="orgheadline60"><span class="section-number-4">5.20.1</span> 确认 <code>b1</code> 与 <code>b2</code> 的共通祖先 <code>A</code></h4>
<div class="outline-text-4" id="text-5-20-1">
<div class="org-src-container">

<pre class="src src-sh">$git merge-base b1 b2
</pre>
</div>
<p>
具体参见 <code>man git merge-base</code> 
</p>
</div>
</div>

<div id="outline-container-orgheadline61" class="outline-4">
<h4 id="orgheadline61"><span class="section-number-4">5.20.2</span> 将 <code>b2</code> 回退到 <code>A</code></h4>
<div class="outline-text-4" id="text-5-20-2">
<div class="org-src-container">

<pre class="src src-sh">$git revert -n A..HEAD
$git commit -m 'roll back to A.'
</pre>
</div>
<p>
注意，如果没有 <code>-n</code>, 将会对 <code>A~HEAD</code> 的每次 commit 生成一个 revert commit.
</p>

<p>
对于出现merge的commit,因为涉及到多个分支的提交，所以会出现错误，需要仔细参考 <code>man</code> 手册，通过 <code>-m</code> 选择revert哪个分支的提交。
</p>

<p>
或者：
</p>
<div class="org-src-container">

<pre class="src src-sh">$git diff HEAD A &gt;rollbackA.diff
$git apply rollbackA.diff
$rm rollbackA.diff
$git add .
$git commit -m 'roll back to A.'
</pre>
</div>
<p>
但是对二进制却不行。
</p>
</div>
</div>

<div id="outline-container-orgheadline62" class="outline-4">
<h4 id="orgheadline62"><span class="section-number-4">5.20.3</span> 将 <code>A</code> 到 <code>b1*</code> 的修改应用到回退完的 <code>b2</code></h4>
<div class="outline-text-4" id="text-5-20-3">
<div class="org-src-container">

<pre class="src src-sh">$git merge --commit b1
</pre>
</div>
<p>
理论上应该没有冲突。
</p>
</div>
</div>
</div>

<div id="outline-container-orgheadline63" class="outline-3">
<h3 id="orgheadline63"><span class="section-number-3">5.21</span> <code>man gitignore</code></h3>
<div class="outline-text-3" id="text-5-21">
<p>
不能工作的方式：
</p>
<pre class="example">
opera-devices-sdk/*
!opera-devices-sdk/include/opera/
!opera-devices-sdk/src/jsplugins/include/*
!opera-devices-sdk/lib/*
!opera-devices-sdk/3rdpartylibs/gstreamer-plugins/*
!opera-devices-sdk/opera_dir/
!opera-devices-sdk/src/uva/include/*
!opera-devices-sdk/utils/fontconfig*/*
!opera-devices-sdk/utils/nss-3*/*
</pre>

<p>
可以工作的方式：
</p>
<pre class="example">
#Ignore list for opera sdk.
#ignore level0 subfiles and list tracked subfiles
opera-devices-sdk/*
!opera-devices-sdk/lib/
!opera-devices-sdk/opera_dir/
!opera-devices-sdk/3rdpartylibs/
!opera-devices-sdk/include/
!opera-devices-sdk/src/
!opera-devices-sdk/utils/
!opera-devices-sdk/pkg-info.json

#ignore level1 subfiles and list tracked subfiles
opera-devices-sdk/3rdpartylibs/*
!opera-devices-sdk/3rdpartylibs/gstreamer-plugins/

opera-devices-sdk/include/*
!opera-devices-sdk/include/opera/

opera-devices-sdk/utils/*
!opera-devices-sdk/utils/fontconfig*/
!opera-devices-sdk/utils/nss-3*/

opera-devices-sdk/src/*
!opera-devices-sdk/src/jsplugins/
!opera-devices-sdk/src/uva/

#ignore level2 subfiles, and list tracked subfiles
opera-devices-sdk/src/jsplugins/*
!opera-devices-sdk/src/jsplugins/include/

opera-devices-sdk/src/uva/*
!opera-devices-sdk/src/uva/include/
</pre>
</div>
</div>

<div id="outline-container-orgheadline64" class="outline-3">
<h3 id="orgheadline64"><span class="section-number-3">5.22</span> git checkout 后退后，如何前进？</h3>
</div>

<div id="outline-container-orgheadline65" class="outline-3">
<h3 id="orgheadline65"><span class="section-number-3">5.23</span> <span class="done REFERENCE">REFERENCE</span> git 二分法定位问题</h3>
<div class="outline-text-3" id="text-5-23">
<ul class="org-ul">
<li>State "NEXT"       from              <span class="timestamp-wrapper"><span class="timestamp">[2017-11-20 一 16:13]</span></span></li>
</ul>
<p>
用于迅速定位到有问题的提交。
</p>
</div>
<div id="outline-container-orgheadline66" class="outline-4">
<h4 id="orgheadline66"><span class="section-number-4">5.23.1</span> 过程</h4>
<div class="outline-text-4" id="text-5-23-1">
<ol class="org-ol">
<li><p>
开始定位
</p>
<div class="org-src-container">

<pre class="src src-sh">$git bisect start
</pre>
</div></li>

<li><p>
设置当前状态
</p>

<div class="org-src-container">

<pre class="src src-sh">$git bisect bad
</pre>
</div></li>

<li><p>
设置第一个印象中好的状态
</p>

<div class="org-src-container">

<pre class="src src-sh">$git bisect good &lt;commit id&gt;
</pre>
</div></li>

<li><p>
测试
</p>

<p>
设置好 <code>bad</code> 和 <code>good</code> 之后，git 会将你切换到一个临时无名分支，进行二分法测试。这个时候，你可以先清理一下工作目录，然后编译、测试等等。
</p></li>

<li><p>
设置测试结果
</p>

<p>
如果测试结果仍旧为坏则 <code>git bisect bad</code>, 如果测试结果为好，则 <code>git bisect good</code>, 之后 <code>git</code> 会按照二分法切换到下一个待测试的提交。
</p></li>

<li><p>
重复 4, 5 直至结束。
</p>

<p>
结束后，git会提示你提交中哪个是最后一个好的，哪个是最后一个坏的。
</p></li>

<li><p>
<code>git bisect reset</code>
</p>

<p>
恢复到原有分支状态。
</p></li>
</ol>

<p>
另外，可以通过 <code>git bisect log</code> 查看当前进行的 <code>git bisect</code> 到了什么地方， 通过 <code>git status</code> 得知我们在二分查找。
</p>
</div>
</div>

<div id="outline-container-orgheadline67" class="outline-4">
<h4 id="orgheadline67"><span class="section-number-4">5.23.2</span> 例子</h4>
<div class="outline-text-4" id="text-5-23-2">
<p>
假设日志如下：
</p>

<pre class="example">
commit a0b8228542cc0385467de07a427b5acefa69ca40
Author: Miracle &lt;miracle.lv@tpv-tech.com&gt;
Date:   Thu Nov 9 15:53:30 2017 +0800

    change 3 again.

commit cf432e81d76a96909d96d5ebb5ca9d16ae5d46b9
Author: Miracle &lt;miracle.lv@tpv-tech.com&gt;
Date:   Thu Nov 9 15:48:18 2017 +0800

    add in mytest.

commit 205c50d452ed076c7b51405b01040c57036c556e
Author: Miracle &lt;miracle.lv@tpv-tech.com&gt;
Date:   Thu Nov 9 15:38:13 2017 +0800

    change1-2

commit 72576a1ea9e437a451f6419d3f9724215d654cd6
Author: Miracle &lt;miracle.lv@tpv-tech.com&gt;
Date:   Thu Nov 9 15:36:27 2017 +0800

    commit tracked file

commit 1ad89234301fc2991fda8d46d5e11928ba523235
Author: Miracle &lt;miracle.lv@tpv-tech.com&gt;
Date:   Fri Jul 28 10:01:42 2017 +0800

    haha.hahaha.tar.gz

(bad)commit 36db099e3b8a279ef90e79b03f246e0bb61c755a
Author: Miracle &lt;miracle.lv@tpv-tech.com&gt;
Date:   Thu Jul 28 16:46:48 2016 +0800

    add hardlink

commit 1037bba71c3b1bd88a2921981bfcefe9b4f67a16
Author: Miracle &lt;miracle.lv@tpv-tech.com&gt;
Date:   Thu Jul 28 16:11:14 2016 +0800

    add absolute softlink and large file

(good)commit 50c65f7db679b170720fb35096f7f6183e01b403
Author: Miracle &lt;miracle.lv@tpv-tech.com&gt;
Date:   Thu Jul 28 16:08:30 2016 +0800

    add 10 with soft link.

commit 3f31e3ab1de8425ea35fcc63143d7554af3493e4
Author: Miracle &lt;miracle.lv@tpv-tech.com&gt;
Date:   Thu Jul 28 16:07:41 2016 +0800

    add init repos
</pre>

<p>
注意这里的 <code>good</code> 表示印象中好用的提交， <code>bad</code> 表示我们要找的第一个引入 <code>bad</code> 的那个目标提交。当前我们在最上面，状态肯定是 <code>bad</code>.
</p>

<p>
过程如下：
</p>
<div class="org-src-container">

<pre class="src src-sh">miracle@xmnb4003210:~/test/git/clone_repos$ git bisect start
miracle@xmnb4003210:~/test/git/clone_repos$ git bisect bad
miracle@xmnb4003210:~/test/git/clone_repos$ git bisect good 50c65f7db679b170720fb35096f7f6183e01b403
Bisecting: 3 revisions left to test after this (roughly 2 steps)
[1ad89234301fc2991fda8d46d5e11928ba523235] haha.hahaha.tar.gz
miracle@xmnb4003210:~/test/git/clone_repos$ git status .
头指针分离于 1ad8923
您在执行从分支 'testremote' 开始的二分查找操作。
  （使用 "git bisect reset" 以回到原有分支）

未跟踪的文件:
  （使用 "git add &lt;文件&gt;..." 以包含要提交的内容）

        0001-change1-2.patch
        0002-add-in-mytest.patch
        0003-change-3-again.patch

提交为空，但是存在尚未跟踪的文件（使用 "git add" 建立跟踪）
miracle@xmnb4003210:~/test/git/clone_repos$ git branch
*（非分支，二分查找开始于 testremote）
  master
  mytest
  testremote
miracle@xmnb4003210:~/test/git/clone_repos$ echo "here we perform test"
here we perform test
miracle@xmnb4003210:~/test/git/clone_repos$ echo "test is bad"
test is bad
miracle@xmnb4003210:~/test/git/clone_repos$ git bisect bad
Bisecting: 0 revisions left to test after this (roughly 1 step)
[36db099e3b8a279ef90e79b03f246e0bb61c755a] add hardlink
miracle@xmnb4003210:~/test/git/clone_repos$ echo "here we perform test"
here we perform test
miracle@xmnb4003210:~/test/git/clone_repos$ echo "test is bad"
test is bad
miracle@xmnb4003210:~/test/git/clone_repos$ git bisect bad
Bisecting: 0 revisions left to test after this (roughly 0 steps)
[1037bba71c3b1bd88a2921981bfcefe9b4f67a16] add absolute softlink and large file
miracle@xmnb4003210:~/test/git/clone_repos$ echo "here we perform test"
here we perform test
miracle@xmnb4003210:~/test/git/clone_repos$ echo "test is good"
test is good
miracle@xmnb4003210:~/test/git/clone_repos$ git bisect good
36db099e3b8a279ef90e79b03f246e0bb61c755a is the first bad commit
commit 36db099e3b8a279ef90e79b03f246e0bb61c755a
Author: Miracle &lt;miracle.lv@tpv-tech.com&gt;
Date:   Thu Jul 28 16:46:48 2016 +0800

    add hardlink

:040000 040000 ff9eb5b2293667abd038c3d9696dc5869df7629e 34f962613f37ba1dda10ebdfc4c441ca786deff8 M      10
miracle@xmnb4003210:~/test/git/clone_repos$ git bisect reset
之前的 HEAD 位置是 1037bba... add absolute softlink and large file
切换到分支 'testremote'
</pre>
</div>
</div>
</div>
<div id="outline-container-orgheadline68" class="outline-4">
<h4 id="orgheadline68"><span class="section-number-4">5.23.3</span> 参考：</h4>
<div class="outline-text-4" id="text-5-23-3">
<p>
<a href="https://git-scm.com/book/zh/v2/Git-%E5%B7%A5%E5%85%B7-%E4%BD%BF%E7%94%A8-Git-%E8%B0%83%E8%AF%95#_binary_search" target="_blank" rel="noopener">https://git-scm.com/book/zh/v2/Git-%E5%B7%A5%E5%85%B7-%E4%BD%BF%E7%94%A8-Git-%E8%B0%83%E8%AF%95#_binary_search</a>
</p>
</div>
</div>
</div>
<div id="outline-container-orgheadline69" class="outline-3">
<h3 id="orgheadline69"><a id="ID-e4b07872-a93a-4f21-b184-c0edbfb2a03b"></a><span class="section-number-3">5.24</span> <span class="done REFERENCE">REFERENCE</span> 使用 <code>git log</code> 或 <code>git rev-list</code> 根据作者和日期筛选提交</h3>
<div class="outline-text-3" id="text-5-24">
<p>
Capture Time:<span class="timestamp-wrapper"><span class="timestamp">[2018-06-04 一 11:37]</span></span>
</p>

<p>
<code>git log</code> 命令可以根据作者、时间等信息过滤提交。但是使用时间范围过滤的时候，需要注意以下：
</p>

<ol class="org-ol">
<li>时间范围是左闭右开的，如 <code>[2018-01-04, 2018-05-30-18:00)</code>.</li>

<li>使用时间范围过滤的时候，这里的时间指的是 <code>CommitDate</code> 而非 <code>AuthorDate</code>.</li>

<li>默认 <code>git log</code> 只显示 <code>AuthorDate</code>, 需要查看 <code>CommitDate</code> 的话，使用 <code>git log --pretty=fuller</code>.</li>
</ol>

<p>
另外，也可以通过 <code>git rev-list start..end</code> 的方式来输出 <code>start..end</code> 范围内的提交，支持和 <code>git log</code> 类似的选项（这里的 <code>start</code> 和 <code>end</code> 是commit id）。
</p>
</div>
<div id="outline-container-orgheadline70" class="outline-4">
<h4 id="orgheadline70"><span class="section-number-4">5.24.1</span> 举例（由来）</h4>
<div class="outline-text-4" id="text-5-24-1">
</div><div id="outline-container-orgheadline80" class="outline-5">
<h5 id="orgheadline80"><span class="section-number-5">5.24.1.1</span> 完整的历史</h5>
<div class="outline-text-5" id="text-5-24-1-1">
<p>
例如，假设有下列历史：
</p>
<div class="org-src-container">

<pre class="src src-sh">$git log
 commit 4763149f715b25fadf9bc4f3984dd774de668845
 Author: gracex.wang &lt;gracex.wang@tpv-tech.com&gt;
 Date:   Tue May 29 18:16:25 2018 +0800

     [Codereview]Add deinit API,mutex protection and Null pointer judgement ect.

     Change-Id: Ie44b11c07e2728ce69169d0176479392d3322c8e

 commit afc73d14bdebbd1991b6b1ebf3fe654caff1f25c
 Author: gracex.wang &lt;gracex.wang@tpv-tech.com&gt;
 Date:   Thu Apr 26 17:50:16 2018 +0800

     [VideobroadcastBackend]Improve timer code to avoid crash issue
     URTRUCKER:TF418PHIEUMTK02-2860

     Change-Id: I3879f6e8e4a7ddb841e1e0242824f1b249de5f8f
 ......
 Author: gracex.wang &lt;gracex.wang@tpv-tech.com&gt;
 Date:   Wed Jan 17 15:31:52 2018 +0800

     [VideoBroadcastBackend]Add nonexistchannel case when setchannel NULL
     URTRACKER:TF418PHIEUMTK02-2708

     Change-Id: I208f6332ee2fbd95cd17bb86e63770e9595ac8d5
     (cherry picked from commit b3435586e179346a91d59580838c22392f4487ce)

 commit bba05e9cd30ec681fe8d6e45afb42c1abd9c1a27
 Author: gracex.wang &lt;gracex.wang@tpv-tech.com&gt;
 Date:   Wed Jan 3 19:49:09 2018 +0800

     [BroadcastBackend]Add ProgrammesChangedEvent in videobroadcast backend according to Opera
     URTRACKER: TF418PHIEUMTK02-3010

     Change-Id: I1d4e21bad71d1de90fd56a38c96f01bb96bf390c
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline81" class="outline-5">
<h5 id="orgheadline81"><span class="section-number-5">5.24.1.2</span> 过滤后的历史（疑惑）</h5>
<div class="outline-text-5" id="text-5-24-1-2">
<p>
现在过滤 <code>gracex</code> 在 <code>[2018-01-04, 2018-05-29)</code> 的提交，貌似需要如下：
</p>
<div class="org-src-container">

<pre class="src src-sh">$git log --author=gracex.wang --since=2018-01-04 --until=2018-05-29
 commit afc73d14bdebbd1991b6b1ebf3fe654caff1f25c
 Author: gracex.wang &lt;gracex.wang@tpv-tech.com&gt;
 Date:   Thu Apr 26 17:50:16 2018 +0800

     [VideobroadcastBackend]Improve timer code to avoid crash issue
     URTRUCKER:TF418PHIEUMTK02-2860

     Change-Id: I3879f6e8e4a7ddb841e1e0242824f1b249de5f8f
 ......
 commit bba05e9cd30ec681fe8d6e45afb42c1abd9c1a27
 Author: gracex.wang &lt;gracex.wang@tpv-tech.com&gt;
 Date:   Wed Jan 3 19:49:09 2018 +0800 

     [BroadcastBackend]Add ProgrammesChangedEvent in videobroadcast backend according to Opera
     URTRACKER: TF418PHIEUMTK02-3010

     Change-Id: I1d4e21bad71d1de90fd56a38c96f01bb96bf390c
$git log --author=gracex.wang --since=2018-01-04 --until=2018-05-30
 commit afc73d14bdebbd1991b6b1ebf3fe654caff1f25c
 Author: gracex.wang &lt;gracex.wang@tpv-tech.com&gt;
 Date:   Thu Apr 26 17:50:16 2018 +0800

     [VideobroadcastBackend]Improve timer code to avoid crash issue
     URTRUCKER:TF418PHIEUMTK02-2860

     Change-Id: I3879f6e8e4a7ddb841e1e0242824f1b249de5f8f
 ......
 commit bba05e9cd30ec681fe8d6e45afb42c1abd9c1a27
 Author: gracex.wang &lt;gracex.wang@tpv-tech.com&gt;
 Date:   Wed Jan 3 19:49:09 2018 +0800 

     [BroadcastBackend]Add ProgrammesChangedEvent in videobroadcast backend according to Opera
     URTRACKER: TF418PHIEUMTK02-3010

     Change-Id: I1d4e21bad71d1de90fd56a38c96f01bb96bf390c
</pre>
</div>
<p>
可是，过滤的结果却让人产生了困惑，问题是：
</p>
<ol class="org-ol">
<li>在第一条中，明明指定 <code>--since=2018-01-04</code>, 怎么过滤出了 <code>2018-01-03</code> 的日志？</li>
<li>在第二条想包含 <code>2018-05-29</code>, 所有指定 <code>--until=2018-05-30=， 可是为什么还是没有输出 =2018-05-29</code> 的日志？</li>
</ol>
</div>
</div>

<div id="outline-container-orgheadline82" class="outline-5">
<h5 id="orgheadline82"><span class="section-number-5">5.24.1.3</span> 包含提交时间的完整历史</h5>
<div class="outline-text-5" id="text-5-24-1-3">
<p>
前面的异常说明，不是 <code>git log</code> 的时间有问题，就是 <code>git log</code> 过滤的结果有误。
</p>

<p>
显然后面的情况，不大可能。换一个方式，加上 <code>--pretty=fuller</code> 选项：
</p>
<div class="org-src-container">

<pre class="src src-sh">$git log --author=gracex --pretty=fuller
commit 4763149f715b25fadf9bc4f3984dd774de668845
Author:     gracex.wang &lt;gracex.wang@tpv-tech.com&gt;
AuthorDate: Tue May 29 18:16:25 2018 +0800
Commit:     Gerrit Code Review &lt;tpv-review@TWCLS071.tpvaoc.com&gt;
CommitDate: Wed May 30 17:59:09 2018 +0800

    [Codereview]Add deinit API,mutex protection and Null pointer judgement ect.

    Change-Id: Ie44b11c07e2728ce69169d0176479392d3322c8e

commit afc73d14bdebbd1991b6b1ebf3fe654caff1f25c
Author:     gracex.wang &lt;gracex.wang@tpv-tech.com&gt;
AuthorDate: Thu Apr 26 17:50:16 2018 +0800
Commit:     Gerrit Code Review &lt;tpv-review@TWCLS071.tpvaoc.com&gt;
CommitDate: Tue May 8 17:44:04 2018 +0800

    [VideobroadcastBackend]Improve timer code to avoid crash issue
    URTRUCKER:TF418PHIEUMTK02-2860

    Change-Id: I3879f6e8e4a7ddb841e1e0242824f1b249de5f8f

......

commit 8eae9515df3f57e2989e2ba9b609881cb678c728
Author:     gracex.wang &lt;gracex.wang@tpv-tech.com&gt;
AuthorDate: Wed Jan 17 15:31:52 2018 +0800
Commit:     Gerrit Code Review &lt;tpv-review@TWCLS071.tpvaoc.com&gt;
CommitDate: Thu Jan 25 18:26:50 2018 +0800

    [VideoBroadcastBackend]Add nonexistchannel case when setchannel NULL
    URTRACKER:TF418PHIEUMTK02-2708

    Change-Id: I208f6332ee2fbd95cd17bb86e63770e9595ac8d5
    (cherry picked from commit b3435586e179346a91d59580838c22392f4487ce)

commit bba05e9cd30ec681fe8d6e45afb42c1abd9c1a27
Author:     gracex.wang &lt;gracex.wang@tpv-tech.com&gt;
AuthorDate: Wed Jan 3 19:49:09 2018 +0800
Commit:     Gerrit Code Review &lt;tpv-review@TWCLS071.tpvaoc.com&gt;
CommitDate: Thu Jan 4 17:29:52 2018 +0800

    [BroadcastBackend]Add ProgrammesChangedEvent in videobroadcast backend according to Opera
    URTRACKER: TF418PHIEUMTK02-3010

    Change-Id: I1d4e21bad71d1de90fd56a38c96f01bb96bf390c
</pre>
</div>

<p>
发现，原来，除了 <code>AuthorDate</code> 之外，还有一个 <code>CommitDate</code>
</p>
</div>
</div>

<div id="outline-container-orgheadline83" class="outline-5">
<h5 id="orgheadline83"><span class="section-number-5">5.24.1.4</span> 过滤后包含提交时间的历史（解决疑惑）</h5>
<div class="outline-text-5" id="text-5-24-1-4">
<p>
那么如下过滤：
</p>
<div class="org-src-container">

<pre class="src src-sh">$git log --author=gracex.wang --since=2018-01-04 --until=2018-05-29 --pretty=fuller
commit afc73d14bdebbd1991b6b1ebf3fe654caff1f25c
Author:     gracex.wang &lt;gracex.wang@tpv-tech.com&gt;
AuthorDate: Thu Apr 26 17:50:16 2018 +0800
Commit:     Gerrit Code Review &lt;tpv-review@TWCLS071.tpvaoc.com&gt;
CommitDate: Tue May 8 17:44:04 2018 +0800

    [VideobroadcastBackend]Improve timer code to avoid crash issue
    URTRUCKER:TF418PHIEUMTK02-2860

    Change-Id: I3879f6e8e4a7ddb841e1e0242824f1b249de5f8f

......

commit bba05e9cd30ec681fe8d6e45afb42c1abd9c1a27
Author:     gracex.wang &lt;gracex.wang@tpv-tech.com&gt;
AuthorDate: Wed Jan 3 19:49:09 2018 +0800
Commit:     Gerrit Code Review &lt;tpv-review@TWCLS071.tpvaoc.com&gt;
CommitDate: Thu Jan 4 17:29:52 2018 +0800

    [BroadcastBackend]Add ProgrammesChangedEvent in videobroadcast backend according to Opera
    URTRACKER: TF418PHIEUMTK02-3010

    Change-Id: I1d4e21bad71d1de90fd56a38c96f01bb96bf390c

$git log --author=gracex.wang --since=2018-01-04 --until=2018-05-30 --pretty=fuller
commit afc73d14bdebbd1991b6b1ebf3fe654caff1f25c
Author:     gracex.wang &lt;gracex.wang@tpv-tech.com&gt;
AuthorDate: Thu Apr 26 17:50:16 2018 +0800
Commit:     Gerrit Code Review &lt;tpv-review@TWCLS071.tpvaoc.com&gt;
CommitDate: Tue May 8 17:44:04 2018 +0800

    [VideobroadcastBackend]Improve timer code to avoid crash issue
    URTRUCKER:TF418PHIEUMTK02-2860

    Change-Id: I3879f6e8e4a7ddb841e1e0242824f1b249de5f8f

......

commit bba05e9cd30ec681fe8d6e45afb42c1abd9c1a27
Author:     gracex.wang &lt;gracex.wang@tpv-tech.com&gt;
AuthorDate: Wed Jan 3 19:49:09 2018 +0800
Commit:     Gerrit Code Review &lt;tpv-review@TWCLS071.tpvaoc.com&gt;
CommitDate: Thu Jan 4 17:29:52 2018 +0800

    [BroadcastBackend]Add ProgrammesChangedEvent in videobroadcast backend according to Opera
    URTRACKER: TF418PHIEUMTK02-3010

    Change-Id: I1d4e21bad71d1de90fd56a38c96f01bb96bf390c

$git log --author=gracex.wang --since=2018-01-04 --until=2018-05-30-18:00 --pretty=fuller
commit 4763149f715b25fadf9bc4f3984dd774de668845
Author:     gracex.wang &lt;gracex.wang@tpv-tech.com&gt;
AuthorDate: Tue May 29 18:16:25 2018 +0800
Commit:     Gerrit Code Review &lt;tpv-review@TWCLS071.tpvaoc.com&gt;
CommitDate: Wed May 30 17:59:09 2018 +0800

    [Codereview]Add deinit API,mutex protection and Null pointer judgement ect.

    Change-Id: Ie44b11c07e2728ce69169d0176479392d3322c8e

......

commit bba05e9cd30ec681fe8d6e45afb42c1abd9c1a27
Author:     gracex.wang &lt;gracex.wang@tpv-tech.com&gt;
AuthorDate: Wed Jan 3 19:49:09 2018 +0800
Commit:     Gerrit Code Review &lt;tpv-review@TWCLS071.tpvaoc.com&gt;
CommitDate: Thu Jan 4 17:29:52 2018 +0800

    [BroadcastBackend]Add ProgrammesChangedEvent in videobroadcast backend according to Opera
    URTRACKER: TF418PHIEUMTK02-3010

    Change-Id: I1d4e21bad71d1de90fd56a38c96f01bb96bf390c
</pre>
</div>

<p>
这就解释了前面的疑惑：
第一条命令，说明过滤的时候，所依据的时间是 <code>CommitDate</code> 而非 <code>AuthorDate</code>.
</p>

<p>
第二条命令，说明时间范围是左闭右开的，如 <code>[2018-01-04, 2018-05-30)</code>
</p>

<p>
第三条命令，说明可以在日期后添加更精确的时间，并且通过比右开区间大的时间，达到选择闭合区间的目的，即：=<span class="timestamp-wrapper"><span class="timestamp">[2018-01-04 四]</span></span>=
</p>
</div>
</div>


<div id="outline-container-orgheadline84" class="outline-5">
<h5 id="orgheadline84"><span class="section-number-5">5.24.1.5</span> 更强大的 <code>git rev-list</code></h5>
<div class="outline-text-5" id="text-5-24-1-5">
<p>
CommitDate 是在学习 <code>git rev-list</code> 时发现的， 进而解决了 <code>git log</code> 过滤的疑惑。
</p>

<p>
<code>git rev-list</code> 命令可以列出指定的提交，选项类似 <code>git log</code>
</p>


<p>
列出 CommitDate 在时间 [date1, date2) 之间的提交，可以这样：
</p>
<div class="org-src-container">

<pre class="src src-sh">$git log --author=xxx --since=&lt;date1&gt; --until=&lt;date2&gt;
$git rev-list --author=xxx ==since=&lt;date1&gt; --until=&lt;date2&gt; HEAD
</pre>
</div>
<p>
两者不同在于， <code>git rev-list</code> 需要额外给出想要列出的提交起始信息，并且只输出 <code>commit id</code> ；而 <code>git log</code> 会给出额外的信息。
</p>

<p>
两者都支持 <code>--pretty</code> 选项调整格式， <code>--pretty=fuller</code> 可以显示出包括 CommitDate 在内的更多信息。
</p>

<p>
举例：
</p>
<div class="org-src-container">

<pre class="src src-sh">$git log --author=fly --since="Fri Jan 19 15:52:22 2018" --until="Tue May 29 11:42:47 2018"
or
$git log --author=fly --since="2018-01-19-15:52" --until="2018-05-29-11:42"
$git rev-list HEAD --author="damon.zhong\|eric.tang\|fly.zhang\|gracex.wang\|ian.chen\|jerome.wang\|miracle.lv\|paul.deng\|rance.li\|vincent.hong" --since=2018-01-01 --pretty=fuller
</pre>
</div>
</div>
</div>
</div>
</div>


<div id="outline-container-orgheadline71" class="outline-3">
<h3 id="orgheadline71"><span class="section-number-3">5.25</span> gerrit操作汇集</h3>
<div class="outline-text-3" id="text-5-25">
</div><div id="outline-container-orgheadline72" class="outline-4">
<h4 id="orgheadline72"><span class="section-number-4">5.25.1</span> local</h4>
<div class="outline-text-4" id="text-5-25-1">
</div><div id="outline-container-orgheadline85" class="outline-5">
<h5 id="orgheadline85"><span class="section-number-5">5.25.1.1</span> 正常流程</h5>
<div class="outline-text-5" id="text-5-25-1-1">
<div class="org-src-container">

<pre class="src src-sh">$git add . #添加修改
$git commit -m 'xxx' #提交到本地
$git push origin HEAD:refs/for/&lt;branch name&gt; #推送到远端
</pre>
</div>
<p>
提交之时，会自动在 commit 的comment上追加一个change id(通过hooks实现), 之后，会在 gerrit的My Changes看到。
</p>

<p>
可以添加reviewer，这样reviewer会收到邮件，让多人参与代码审核。
</p>
</div>
</div>

<div id="outline-container-orgheadline86" class="outline-5">
<h5 id="orgheadline86"><span class="section-number-5">5.25.1.2</span> 在已有的change id上修改</h5>
<div class="outline-text-5" id="text-5-25-1-2">
<div class="org-src-container">

<pre class="src src-sh">$git add .
$git commit --amend
$git push origin HEAD:refs/for/&lt;branch name&gt;
</pre>
</div>

<p>
如果追加到同样的 change id， 用此方法。
</p>
</div>
</div>

<div id="outline-container-orgheadline87" class="outline-5">
<h5 id="orgheadline87"><span class="section-number-5">5.25.1.3</span> 临时草稿</h5>
<div class="outline-text-5" id="text-5-25-1-3">
<div class="org-src-container">

<pre class="src src-sh">$git push origin HEAD:refs/drafts/&lt;branch name&gt;
</pre>
</div>

<p>
这个方法，可以添加到gerrit的My Drafts中，用于临时修改， 最终 Publish后会进入到 My Changes中。
</p>
</div>
</div>

<div id="outline-container-orgheadline88" class="outline-5">
<h5 id="orgheadline88"><span class="section-number-5">5.25.1.4</span> 提前添加reviewer</h5>
<div class="outline-text-5" id="text-5-25-1-4">
<div class="org-src-container">

<pre class="src src-sh">$git push origin HEAD:refs/drafts/2K18_UI_FFC_tpv%r=jerome.wang@tpv-tech.com,r=lam.lin@tpv-tech.com,r=kiko.han@tpv-tech.com,r=eric.tang@tpv-tech.com,r=gracex.wang@tpv-tech.com,r=paul.deng@tpv-tech.com
</pre>
</div>
<p>
这样，可以在提交的时候添加reviewer,而不用在gerrit添加了。
</p>
</div>
</div>

<div id="outline-container-orgheadline89" class="outline-5">
<h5 id="orgheadline89"><span class="section-number-5">5.25.1.5</span> 查看当前代码所在的git目录路径</h5>
<div class="outline-text-5" id="text-5-25-1-5">
<div class="org-src-container">

<pre class="src src-sh">$git rev-parse --git-dir
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline90" class="outline-5">
<h5 id="orgheadline90"><span class="section-number-5">5.25.1.6</span> 拷贝远端hook</h5>
<div class="outline-text-5" id="text-5-25-1-6">
<p>
比如添加脚本使得commit时会产生gerrit的change id便于push。
</p>
<div class="org-src-container">

<pre class="src src-sh">$scp -p -P &lt;port&gt; &lt;user&gt;@&lt;ip&gt;:hooks/commit-msg .git/hooks
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgheadline73" class="outline-4">
<h4 id="orgheadline73"><span class="section-number-4">5.25.2</span> remote</h4>
<div class="outline-text-4" id="text-5-25-2">
<p>
change id不是commit id, commit id和 change id可以直接在gerrit上搜索定位。
</p>
</div>
</div>
</div>

<div id="outline-container-orgheadline74" class="outline-3">
<h3 id="orgheadline74"><span class="section-number-3">5.26</span> 找到丢失的历史</h3>
<div class="outline-text-3" id="text-5-26">
<p>
参考： <a href="https://blog.csdn.net/yasin_lee/article/details/51145614" target="_blank" rel="noopener">https://blog.csdn.net/yasin_lee/article/details/51145614</a>
</p>

<pre class="example">
比如：执行checkout -f 或 reset -hard 或 branch -d删除一个分支
结果造成本地（远程）的分支或某些commit丢失
可以通过reflog来进行恢复，前提是丢失的分支或commit信息没有被git gc清除
一般情况下，gc对那些无用的object会保留很长时间后才清除的
reflog是git提供的一个内部工具，用于记录对git仓库进行的各种操作
可以使用git reflog show或git log -g命令来看到所有的操作日志
</pre>
</div>
</div>
</div>

                    </div>
                </article>                        
                
                <!--{% include duoshuo_comment.ext %}-->
            </td>
        </tr>
        <tr>
            <td id="td_page_footer" colspan="6">
    <footer>
        &copy 2015
    </footer>
    <a id="bottom"></a>
</td>
        </tr>
    </tbody>
</table>
    </main>
  </body>
</html>